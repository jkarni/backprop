<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DataKinds              #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE EmptyCase              #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts       #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances      #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GADTs                  #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase             #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses  #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms        #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes             #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables    #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications       #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators          #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances   #-}</span><span>
</span><span id="line-15"></span><span class="hs-pragma">{-# OPTIONS_HADDOCK not-home        #-}</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-comment">-- |</span><span>
</span><span id="line-18"></span><span class="hs-comment">-- Module      : Numeric.Backprop.Explicit</span><span>
</span><span id="line-19"></span><span class="hs-comment">-- Copyright   : (c) Justin Le 2018</span><span>
</span><span id="line-20"></span><span class="hs-comment">-- License     : BSD3</span><span>
</span><span id="line-21"></span><span class="hs-comment">--</span><span>
</span><span id="line-22"></span><span class="hs-comment">-- Maintainer  : justin@jle.im</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- Stability   : experimental</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- Portability : non-portable</span><span>
</span><span id="line-25"></span><span class="hs-comment">--</span><span>
</span><span id="line-26"></span><span class="hs-comment">-- Provides &quot;explicit&quot; versions of all of the functions in</span><span>
</span><span id="line-27"></span><span class="hs-comment">-- &quot;Numeric.Backprop&quot;.  Instead of relying on a 'Backprop' instance, allows</span><span>
</span><span id="line-28"></span><span class="hs-comment">-- you to manually provide 'zero', 'add', and 'one' on a per-value basis.</span><span>
</span><span id="line-29"></span><span class="hs-comment">--</span><span>
</span><span id="line-30"></span><span class="hs-comment">-- It is recommended you use &quot;Numeric.Backprop&quot; or &quot;Numeric.Backprop.Num&quot;</span><span>
</span><span id="line-31"></span><span class="hs-comment">-- instead, unless your type has no 'Num' instance, or you else you want to</span><span>
</span><span id="line-32"></span><span class="hs-comment">-- avoid defining orphan 'Backprop' instances for external types.  Can also</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- be useful if mixing and matching styles.</span><span>
</span><span id="line-34"></span><span class="hs-comment">--</span><span>
</span><span id="line-35"></span><span class="hs-comment">-- See &quot;Numeric.Backprop&quot; for fuller documentation on using these</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- functions.</span><span>
</span><span id="line-37"></span><span class="hs-comment">--</span><span>
</span><span id="line-38"></span><span class="hs-comment">-- WARNING: API of this module can be considered only &quot;semi-stable&quot;; while</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- the API of &quot;Numeric.Backprop&quot; and &quot;Numeric.Backprop.Num&quot; are kept</span><span>
</span><span id="line-40"></span><span class="hs-comment">-- consistent, some argument order changes might happen in this module to</span><span>
</span><span id="line-41"></span><span class="hs-comment">-- reflect changes in underlying implementation.</span><span>
</span><span id="line-42"></span><span class="hs-comment">--</span><span>
</span><span id="line-43"></span><span class="hs-comment">-- @since 0.2.0.0</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Numeric.Backprop.Explicit</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Types</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier">BVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier">W</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Class.html#Backprop"><span class="hs-identifier">Backprop</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Class.html#ABP"><span class="hs-identifier">ABP</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Class.html#NumBP"><span class="hs-identifier">NumBP</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Explicit 'zero', 'add', and 'one'</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier">ZeroFunc</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#zfNum"><span class="hs-identifier">zfNum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#zfNums"><span class="hs-identifier">zfNums</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#zeroFunc"><span class="hs-identifier">zeroFunc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#zeroFuncs"><span class="hs-identifier">zeroFuncs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#zfFunctor"><span class="hs-identifier">zfFunctor</span></a></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier">AddFunc</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#afNum"><span class="hs-identifier">afNum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#afNums"><span class="hs-identifier">afNums</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#addFunc"><span class="hs-identifier">addFunc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#addFuncs"><span class="hs-identifier">addFuncs</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#OneFunc"><span class="hs-identifier">OneFunc</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ofNum"><span class="hs-identifier">ofNum</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#ofNums"><span class="hs-identifier">ofNums</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#oneFunc"><span class="hs-identifier">oneFunc</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#oneFuncs"><span class="hs-identifier">oneFuncs</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#ofFunctor"><span class="hs-identifier">ofFunctor</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Running</span></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#backprop"><span class="hs-identifier">backprop</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#evalBP"><span class="hs-identifier">evalBP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gradBP"><span class="hs-identifier">gradBP</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#backpropWith"><span class="hs-identifier">backpropWith</span></a></span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Multiple inputs</span></span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#evalBP0"><span class="hs-identifier">evalBP0</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#backprop2"><span class="hs-identifier">backprop2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#evalBP2"><span class="hs-identifier">evalBP2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gradBP2"><span class="hs-identifier">gradBP2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#backpropWith2"><span class="hs-identifier">backpropWith2</span></a></span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#backpropN"><span class="hs-identifier">backpropN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#evalBPN"><span class="hs-identifier">evalBPN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gradBPN"><span class="hs-identifier">gradBPN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#backpropWithN"><span class="hs-identifier">backpropWithN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">RPureConstrained</span></span><span>
</span><span id="line-58"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Manipulating 'BVar'</span></span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#constVar"><span class="hs-identifier">constVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#auto"><span class="hs-identifier">auto</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#coerceVar"><span class="hs-identifier">coerceVar</span></a></span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#viewVar"><span class="hs-identifier">viewVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#setVar"><span class="hs-identifier">setVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#overVar"><span class="hs-identifier">overVar</span></a></span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#sequenceVar"><span class="hs-identifier">sequenceVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#collectVar"><span class="hs-identifier">collectVar</span></a></span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#previewVar"><span class="hs-identifier">previewVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#toListOfVar"><span class="hs-identifier">toListOfVar</span></a></span><span>
</span><span id="line-63"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** With Isomorphisms</span></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVar"><span class="hs-identifier">isoVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVar2"><span class="hs-identifier">isoVar2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVar3"><span class="hs-identifier">isoVar3</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVarN"><span class="hs-identifier">isoVarN</span></a></span><span>
</span><span id="line-65"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** With 'Op's</span></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#liftOp"><span class="hs-identifier">liftOp</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#liftOp1"><span class="hs-identifier">liftOp1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#liftOp2"><span class="hs-identifier">liftOp2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#liftOp3"><span class="hs-identifier">liftOp3</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Generics</span></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#splitBV"><span class="hs-identifier">splitBV</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#joinBV"><span class="hs-identifier">joinBV</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier">BVGroup</span></a></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="hs-comment">-- * 'Op'</span></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#Op"><span class="hs-identifier">Op</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><span class="hs-comment">-- ** Creation</span></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#op0"><span class="hs-identifier">op0</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#opConst"><span class="hs-identifier">opConst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#idOp"><span class="hs-identifier">idOp</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#bpOp"><span class="hs-identifier">bpOp</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** Giving gradients directly</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#op1"><span class="hs-identifier">op1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#op2"><span class="hs-identifier">op2</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#op3"><span class="hs-identifier">op3</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** From Isomorphisms</span></span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#opCoerce"><span class="hs-identifier">opCoerce</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#opTup"><span class="hs-identifier">opTup</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#opIso"><span class="hs-identifier">opIso</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#opIsoN"><span class="hs-identifier">opIsoN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#opLens"><span class="hs-identifier">opLens</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="annot"><span class="hs-comment">-- *** No gradients</span></span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#noGrad1"><span class="hs-identifier">noGrad1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#noGrad"><span class="hs-identifier">noGrad</span></a></span><span>
</span><span id="line-83"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Utility</span></span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Reifies</span></span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Bifunctor</span></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Functor.Identity</span></span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Reflection</span></span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Data.Type.Util.html"><span class="hs-identifier">Data.Type.Util</span></a></span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Vinyl.Core</span></span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Data.Vinyl.TypeLevel</span></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">GHC.Generics</span></span><span>              </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">G</span></span><span>
</span><span id="line-94"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Lens.Micro</span></span><span>
</span><span id="line-95"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Numeric.Backprop.Class.html"><span class="hs-identifier">Numeric.Backprop.Class</span></a></span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Numeric.Backprop.Internal.html"><span class="hs-identifier">Numeric.Backprop.Internal</span></a></span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Numeric.Backprop.Op.html"><span class="hs-identifier">Numeric.Backprop.Op</span></a></span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><span class="hs-identifier">Unsafe.Coerce</span></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span class="hs-comment">-- | 'ZeroFunc's for every item in a type level list based on their</span><span>
</span><span id="line-101"></span><span class="hs-comment">-- 'Num' instances</span><span>
</span><span id="line-102"></span><span class="hs-comment">--</span><span>
</span><span id="line-103"></span><span class="hs-comment">-- @since 0.2.0.0</span><span>
</span><span id="line-104"></span><span id="local-6989586621679149614"><span class="annot"><a href="Numeric.Backprop.Explicit.html#zfNums"><span class="hs-identifier hs-type">zfNums</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RPureConstrained</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679149614"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149614"><span class="hs-keyword hs-type">as</span></a></span></span><span>
</span><span id="line-105"></span><span id="zfNums"><span class="annot"><span class="annottext">zfNums :: Rec ZeroFunc as
</span><a href="Numeric.Backprop.Explicit.html#zfNums"><span class="hs-identifier hs-var hs-var">zfNums</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Num a =&gt; ZeroFunc a) -&gt; Rec ZeroFunc as
forall u (c :: u -&gt; Constraint) (ts :: [u]) (f :: u -&gt; *).
RPureConstrained c ts =&gt;
(forall (a :: u). c a =&gt; f a) -&gt; Rec f ts
</span><span class="hs-identifier hs-var">rpureConstrained</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; ZeroFunc a
</span><a href="Numeric.Backprop.Internal.html#zfNum"><span class="hs-identifier hs-var">zfNum</span></a></span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="hs-comment">-- | 'zeroFunc' for instances of 'Functor'</span><span>
</span><span id="line-108"></span><span class="hs-comment">--</span><span>
</span><span id="line-109"></span><span class="hs-comment">-- @since 0.2.1.0</span><span>
</span><span id="line-110"></span><span id="local-6989586621679149611"><span id="local-6989586621679149612"><span class="annot"><a href="Numeric.Backprop.Explicit.html#zfFunctor"><span class="hs-identifier hs-type">zfFunctor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Class.html#Backprop"><span class="hs-identifier hs-type">Backprop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149612"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679149611"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149611"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149612"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-111"></span><span id="zfFunctor"><span class="annot"><span class="annottext">zfFunctor :: ZeroFunc (f a)
</span><a href="Numeric.Backprop.Explicit.html#zfFunctor"><span class="hs-identifier hs-var hs-var">zfFunctor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f a -&gt; f a) -&gt; ZeroFunc (f a)
forall a. (a -&gt; a) -&gt; ZeroFunc a
</span><a href="Numeric.Backprop.Internal.html#ZF"><span class="hs-identifier hs-var">ZF</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; f a
forall (f :: * -&gt; *) a. (Functor f, Backprop a) =&gt; f a -&gt; f a
</span><a href="Numeric.Backprop.Class.html#zeroFunctor"><span class="hs-identifier hs-var">zeroFunctor</span></a></span><span>
</span><span id="line-112"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#zfFunctor"><span class="hs-pragma hs-type">zfFunctor</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="hs-comment">-- | 'ZeroFunc's for every item in a type level list based on their</span><span>
</span><span id="line-115"></span><span class="hs-comment">-- 'Num' instances</span><span>
</span><span id="line-116"></span><span class="hs-comment">--</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- @since 0.2.0.0</span><span>
</span><span id="line-118"></span><span id="local-6989586621679149608"><span class="annot"><a href="Numeric.Backprop.Explicit.html#afNums"><span class="hs-identifier hs-type">afNums</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RPureConstrained</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679149608"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149608"><span class="hs-keyword hs-type">as</span></a></span></span><span>
</span><span id="line-119"></span><span id="afNums"><span class="annot"><span class="annottext">afNums :: Rec AddFunc as
</span><a href="Numeric.Backprop.Explicit.html#afNums"><span class="hs-identifier hs-var hs-var">afNums</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Num a =&gt; AddFunc a) -&gt; Rec AddFunc as
forall u (c :: u -&gt; Constraint) (ts :: [u]) (f :: u -&gt; *).
RPureConstrained c ts =&gt;
(forall (a :: u). c a =&gt; f a) -&gt; Rec f ts
</span><span class="hs-identifier hs-var">rpureConstrained</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; AddFunc a
</span><a href="Numeric.Backprop.Internal.html#afNum"><span class="hs-identifier hs-var">afNum</span></a></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="hs-comment">-- | 'ZeroFunc's for every item in a type level list based on their</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- 'Num' instances</span><span>
</span><span id="line-123"></span><span class="hs-comment">--</span><span>
</span><span id="line-124"></span><span class="hs-comment">-- @since 0.2.0.0</span><span>
</span><span id="line-125"></span><span id="local-6989586621679149607"><span class="annot"><a href="Numeric.Backprop.Explicit.html#ofNums"><span class="hs-identifier hs-type">ofNums</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RPureConstrained</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><a href="#local-6989586621679149607"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#OneFunc"><span class="hs-identifier hs-type">OneFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149607"><span class="hs-keyword hs-type">as</span></a></span></span><span>
</span><span id="line-126"></span><span id="ofNums"><span class="annot"><span class="annottext">ofNums :: Rec OneFunc as
</span><a href="Numeric.Backprop.Explicit.html#ofNums"><span class="hs-identifier hs-var hs-var">ofNums</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Num a =&gt; OneFunc a) -&gt; Rec OneFunc as
forall u (c :: u -&gt; Constraint) (ts :: [u]) (f :: u -&gt; *).
RPureConstrained c ts =&gt;
(forall (a :: u). c a =&gt; f a) -&gt; Rec f ts
</span><span class="hs-identifier hs-var">rpureConstrained</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Num</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; OneFunc a
</span><a href="Numeric.Backprop.Internal.html#ofNum"><span class="hs-identifier hs-var">ofNum</span></a></span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-comment">-- | 'OneFunc' for instances of 'Functor'</span><span>
</span><span id="line-129"></span><span class="hs-comment">--</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- @since 0.2.1.0</span><span>
</span><span id="line-131"></span><span id="local-6989586621679149605"><span id="local-6989586621679149606"><span class="annot"><a href="Numeric.Backprop.Explicit.html#ofFunctor"><span class="hs-identifier hs-type">ofFunctor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Class.html#Backprop"><span class="hs-identifier hs-type">Backprop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Functor</span></span><span> </span><span class="annot"><a href="#local-6989586621679149605"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#OneFunc"><span class="hs-identifier hs-type">OneFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149605"><span class="hs-identifier hs-type">f</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149606"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-132"></span><span id="ofFunctor"><span class="annot"><span class="annottext">ofFunctor :: OneFunc (f a)
</span><a href="Numeric.Backprop.Explicit.html#ofFunctor"><span class="hs-identifier hs-var hs-var">ofFunctor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(f a -&gt; f a) -&gt; OneFunc (f a)
forall a. (a -&gt; a) -&gt; OneFunc a
</span><a href="Numeric.Backprop.Internal.html#OF"><span class="hs-identifier hs-var">OF</span></a></span><span> </span><span class="annot"><span class="annottext">f a -&gt; f a
forall (f :: * -&gt; *) a. (Functor f, Backprop a) =&gt; f a -&gt; f a
</span><a href="Numeric.Backprop.Class.html#oneFunctor"><span class="hs-identifier hs-var">oneFunctor</span></a></span><span>
</span><span id="line-133"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#ofFunctor"><span class="hs-pragma hs-type">ofFunctor</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Generate an 'ZeroFunc' for every type in a type-level list, if every</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- type has an instance of 'Backprop'.</span><span>
</span><span id="line-137"></span><span class="hs-comment">--</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- @since 0.2.0.0</span><span>
</span><span id="line-139"></span><span id="local-6989586621679149602"><span class="annot"><a href="Numeric.Backprop.Explicit.html#zeroFuncs"><span class="hs-identifier hs-type">zeroFuncs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RPureConstrained</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Class.html#Backprop"><span class="hs-identifier hs-type">Backprop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149602"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149602"><span class="hs-keyword hs-type">as</span></a></span></span><span>
</span><span id="line-140"></span><span id="zeroFuncs"><span class="annot"><span class="annottext">zeroFuncs :: Rec ZeroFunc as
</span><a href="Numeric.Backprop.Explicit.html#zeroFuncs"><span class="hs-identifier hs-var hs-var">zeroFuncs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Backprop a =&gt; ZeroFunc a) -&gt; Rec ZeroFunc as
forall u (c :: u -&gt; Constraint) (ts :: [u]) (f :: u -&gt; *).
RPureConstrained c ts =&gt;
(forall (a :: u). c a =&gt; f a) -&gt; Rec f ts
</span><span class="hs-identifier hs-var">rpureConstrained</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Numeric.Backprop.Class.html#Backprop"><span class="hs-identifier hs-type">Backprop</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Backprop a =&gt; ZeroFunc a
</span><a href="Numeric.Backprop.Internal.html#zeroFunc"><span class="hs-identifier hs-var">zeroFunc</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="hs-comment">-- | Generate an 'AddFunc' for every type in a type-level list, if every</span><span>
</span><span id="line-143"></span><span class="hs-comment">-- type has an instance of 'Backprop'.</span><span>
</span><span id="line-144"></span><span class="hs-comment">--</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- @since 0.2.0.0</span><span>
</span><span id="line-146"></span><span id="local-6989586621679149601"><span class="annot"><a href="Numeric.Backprop.Explicit.html#addFuncs"><span class="hs-identifier hs-type">addFuncs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RPureConstrained</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Class.html#Backprop"><span class="hs-identifier hs-type">Backprop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149601"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149601"><span class="hs-keyword hs-type">as</span></a></span></span><span>
</span><span id="line-147"></span><span id="addFuncs"><span class="annot"><span class="annottext">addFuncs :: Rec AddFunc as
</span><a href="Numeric.Backprop.Explicit.html#addFuncs"><span class="hs-identifier hs-var hs-var">addFuncs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Backprop a =&gt; AddFunc a) -&gt; Rec AddFunc as
forall u (c :: u -&gt; Constraint) (ts :: [u]) (f :: u -&gt; *).
RPureConstrained c ts =&gt;
(forall (a :: u). c a =&gt; f a) -&gt; Rec f ts
</span><span class="hs-identifier hs-var">rpureConstrained</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Numeric.Backprop.Class.html#Backprop"><span class="hs-identifier hs-type">Backprop</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Backprop a =&gt; AddFunc a
</span><a href="Numeric.Backprop.Internal.html#addFunc"><span class="hs-identifier hs-var">addFunc</span></a></span><span>
</span><span id="line-148"></span><span>
</span><span id="line-149"></span><span class="hs-comment">-- | Generate an 'OneFunc' for every type in a type-level list, if every</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- type has an instance of 'Backprop'.</span><span>
</span><span id="line-151"></span><span class="hs-comment">--</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- @since 0.2.0.0</span><span>
</span><span id="line-153"></span><span id="local-6989586621679149600"><span class="annot"><a href="Numeric.Backprop.Explicit.html#oneFuncs"><span class="hs-identifier hs-type">oneFuncs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RPureConstrained</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Class.html#Backprop"><span class="hs-identifier hs-type">Backprop</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149600"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#OneFunc"><span class="hs-identifier hs-type">OneFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149600"><span class="hs-keyword hs-type">as</span></a></span></span><span>
</span><span id="line-154"></span><span id="oneFuncs"><span class="annot"><span class="annottext">oneFuncs :: Rec OneFunc as
</span><a href="Numeric.Backprop.Explicit.html#oneFuncs"><span class="hs-identifier hs-var hs-var">oneFuncs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall a. Backprop a =&gt; OneFunc a) -&gt; Rec OneFunc as
forall u (c :: u -&gt; Constraint) (ts :: [u]) (f :: u -&gt; *).
RPureConstrained c ts =&gt;
(forall (a :: u). c a =&gt; f a) -&gt; Rec f ts
</span><span class="hs-identifier hs-var">rpureConstrained</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="Numeric.Backprop.Class.html#Backprop"><span class="hs-identifier hs-type">Backprop</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Backprop a =&gt; OneFunc a
</span><a href="Numeric.Backprop.Internal.html#oneFunc"><span class="hs-identifier hs-var">oneFunc</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- | Shorter alias for 'constVar', inspired by the /ad/ library.</span><span>
</span><span id="line-157"></span><span class="hs-comment">--</span><span>
</span><span id="line-158"></span><span class="hs-comment">-- @since 0.2.0.0</span><span>
</span><span id="line-159"></span><span id="local-6989586621679149598"><span id="local-6989586621679149599"><span class="annot"><a href="Numeric.Backprop.Explicit.html#auto"><span class="hs-identifier hs-type">auto</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679149599"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149598"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149599"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-160"></span><span id="auto"><span class="annot"><span class="annottext">auto :: a -&gt; BVar s a
</span><a href="Numeric.Backprop.Explicit.html#auto"><span class="hs-identifier hs-var hs-var">auto</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; BVar s a
forall a s. a -&gt; BVar s a
</span><a href="Numeric.Backprop.Internal.html#constVar"><span class="hs-identifier hs-var">constVar</span></a></span><span>
</span><span id="line-161"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#auto"><span class="hs-pragma hs-type">auto</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- | 'Numeric.Backprop.backpropN', but with explicit 'zero' and 'one'.</span><span>
</span><span id="line-164"></span><span class="annot"><a href="Numeric.Backprop.Explicit.html#backpropN"><span class="hs-identifier hs-type">backpropN</span></a></span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149946"><span class="annot"><a href="#local-6989586621679149946"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679149945"><span class="annot"><a href="#local-6989586621679149945"><span class="hs-identifier hs-type">b</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149946"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#OneFunc"><span class="hs-identifier hs-type">OneFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149945"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149964"><span class="annot"><a href="#local-6989586621679149964"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149964"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149964"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679149946"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149964"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149945"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><a href="#local-6989586621679149946"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149945"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><a href="#local-6989586621679149946"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span id="backpropN"><span class="annot"><span class="annottext">backpropN :: Rec ZeroFunc as
-&gt; OneFunc b
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; (b, Rec Identity as)
</span><a href="Numeric.Backprop.Explicit.html#backpropN"><span class="hs-identifier hs-var hs-var">backpropN</span></a></span></span><span> </span><span id="local-6989586621679149597"><span class="annot"><span class="annottext">zfs :: Rec ZeroFunc as
</span><a href="#local-6989586621679149597"><span class="hs-identifier hs-var">zfs</span></a></span></span><span> </span><span id="local-6989586621679149596"><span class="annot"><span class="annottext">ob :: OneFunc b
</span><a href="#local-6989586621679149596"><span class="hs-identifier hs-var">ob</span></a></span></span><span> </span><span id="local-6989586621679149595"><span class="annot"><span class="annottext">f :: forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b
</span><a href="#local-6989586621679149595"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679149594"><span class="annot"><span class="annottext">xs :: Rec Identity as
</span><a href="#local-6989586621679149594"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; (b, b -&gt; Rec Identity as)
forall (as :: [*]) b.
Rec ZeroFunc as
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; (b, b -&gt; Rec Identity as)
</span><a href="Numeric.Backprop.Internal.html#backpropWithN"><span class="hs-identifier hs-var">backpropWithN</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
</span><a href="#local-6989586621679149597"><span class="hs-identifier hs-var">zfs</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b
</span><a href="#local-6989586621679149595"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Identity as
</span><a href="#local-6989586621679149594"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679149593"><span class="annot"><span class="annottext">y :: b
</span><a href="#local-6989586621679149593"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149592"><span class="annot"><span class="annottext">g :: b -&gt; Rec Identity as
</span><a href="#local-6989586621679149592"><span class="hs-identifier hs-var">g</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679149593"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b -&gt; Rec Identity as
</span><a href="#local-6989586621679149592"><span class="hs-identifier hs-var">g</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OneFunc b -&gt; b -&gt; b
forall a. OneFunc a -&gt; a -&gt; a
</span><a href="Numeric.Backprop.Internal.html#runOF"><span class="hs-identifier hs-var hs-var">runOF</span></a></span><span> </span><span class="annot"><span class="annottext">OneFunc b
</span><a href="#local-6989586621679149596"><span class="hs-identifier hs-var">ob</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679149593"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#backpropN"><span class="hs-pragma hs-type">backpropN</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span class="hs-comment">-- | 'Numeric.Backprop.backprop', but with explicit 'zero' and 'one'.</span><span>
</span><span id="line-176"></span><span id="local-6989586621679149913"><span id="local-6989586621679149914"><span class="annot"><a href="Numeric.Backprop.Explicit.html#backprop"><span class="hs-identifier hs-type">backprop</span></a></span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149914"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#OneFunc"><span class="hs-identifier hs-type">OneFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149913"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149955"><span class="annot"><a href="#local-6989586621679149955"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149955"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149955"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149914"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149955"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149913"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149914"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149913"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149914"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-182"></span><span id="backprop"><span class="annot"><span class="annottext">backprop :: ZeroFunc a
-&gt; OneFunc b
-&gt; (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b)
-&gt; a
-&gt; (b, a)
</span><a href="Numeric.Backprop.Explicit.html#backprop"><span class="hs-identifier hs-var hs-var">backprop</span></a></span></span><span> </span><span id="local-6989586621679149590"><span class="annot"><span class="annottext">zfa :: ZeroFunc a
</span><a href="#local-6989586621679149590"><span class="hs-identifier hs-var">zfa</span></a></span></span><span> </span><span id="local-6989586621679149589"><span class="annot"><span class="annottext">ofb :: OneFunc b
</span><a href="#local-6989586621679149589"><span class="hs-identifier hs-var">ofb</span></a></span></span><span> </span><span id="local-6989586621679149588"><span class="annot"><span class="annottext">f :: forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b
</span><a href="#local-6989586621679149588"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rec Identity '[a] -&gt; a) -&gt; (b, Rec Identity '[a]) -&gt; (b, a)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span id="local-6989586621679149585"><span class="annot"><a href="#local-6989586621679149585"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RNil</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149585"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>                   </span><span class="annot"><span class="annottext">((b, Rec Identity '[a]) -&gt; (b, a))
-&gt; (a -&gt; (b, Rec Identity '[a])) -&gt; a -&gt; (b, a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc '[a]
-&gt; OneFunc b
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) '[a] -&gt; BVar s b)
-&gt; Rec Identity '[a]
-&gt; (b, Rec Identity '[a])
forall (as :: [*]) b.
Rec ZeroFunc as
-&gt; OneFunc b
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; (b, Rec Identity as)
</span><a href="Numeric.Backprop.Explicit.html#backpropN"><span class="hs-identifier hs-var">backpropN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZeroFunc a
</span><a href="#local-6989586621679149590"><span class="hs-identifier hs-var">zfa</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc a -&gt; Rec ZeroFunc '[] -&gt; Rec ZeroFunc '[a]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OneFunc b
</span><a href="#local-6989586621679149589"><span class="hs-identifier hs-var">ofb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVar s a -&gt; BVar s b
forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b
</span><a href="#local-6989586621679149588"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(BVar s a -&gt; BVar s b)
-&gt; (Rec (BVar s) '[a] -&gt; BVar s a) -&gt; Rec (BVar s) '[a] -&gt; BVar s b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span id="local-6989586621679149581"><span class="annot"><span class="annottext">x :: BVar s r
</span><a href="#local-6989586621679149581"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RNil</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BVar s a
BVar s r
</span><a href="#local-6989586621679149581"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-184"></span><span>                   </span><span class="annot"><span class="annottext">(Rec Identity '[a] -&gt; (b, Rec Identity '[a]))
-&gt; (a -&gt; Rec Identity '[a]) -&gt; a -&gt; (b, Rec Identity '[a])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identity a -&gt; Rec Identity '[] -&gt; Rec Identity '[a]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rec Identity '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>                   </span><span class="annot"><span class="annottext">(Identity a -&gt; Rec Identity '[a])
-&gt; (a -&gt; Identity a) -&gt; a -&gt; Rec Identity '[a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Identity a
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span>
</span><span id="line-186"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#backprop"><span class="hs-pragma hs-type">backprop</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- | 'Numeric.Backprop.backpropWith', but with explicit 'zero'.</span><span>
</span><span id="line-189"></span><span class="hs-comment">--</span><span>
</span><span id="line-190"></span><span class="hs-comment">-- Note that argument order changed in v0.2.4.</span><span>
</span><span id="line-191"></span><span id="local-6989586621679149579"><span id="local-6989586621679149580"><span class="annot"><a href="Numeric.Backprop.Explicit.html#backpropWith"><span class="hs-identifier hs-type">backpropWith</span></a></span><span>
</span><span id="line-192"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149580"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149936"><span class="annot"><a href="#local-6989586621679149936"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149936"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149936"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149580"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149936"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149579"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149580"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149579"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149579"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149580"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-196"></span><span id="backpropWith"><span class="annot"><span class="annottext">backpropWith :: ZeroFunc a
-&gt; (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b)
-&gt; a
-&gt; (b, b -&gt; a)
</span><a href="Numeric.Backprop.Explicit.html#backpropWith"><span class="hs-identifier hs-var hs-var">backpropWith</span></a></span></span><span> </span><span id="local-6989586621679149578"><span class="annot"><span class="annottext">zfa :: ZeroFunc a
</span><a href="#local-6989586621679149578"><span class="hs-identifier hs-var">zfa</span></a></span></span><span> </span><span id="local-6989586621679149577"><span class="annot"><span class="annottext">f :: forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b
</span><a href="#local-6989586621679149577"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((b -&gt; Rec Identity '[a]) -&gt; b -&gt; a)
-&gt; (b, b -&gt; Rec Identity '[a]) -&gt; (b, b -&gt; a)
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span id="local-6989586621679149576"><span class="annot"><a href="#local-6989586621679149576"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RNil</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149576"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Rec Identity '[a] -&gt; a) -&gt; (b -&gt; Rec Identity '[a]) -&gt; b -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>                   </span><span class="annot"><span class="annottext">((b, b -&gt; Rec Identity '[a]) -&gt; (b, b -&gt; a))
-&gt; (a -&gt; (b, b -&gt; Rec Identity '[a])) -&gt; a -&gt; (b, b -&gt; a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc '[a]
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) '[a] -&gt; BVar s b)
-&gt; Rec Identity '[a]
-&gt; (b, b -&gt; Rec Identity '[a])
forall (as :: [*]) b.
Rec ZeroFunc as
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; (b, b -&gt; Rec Identity as)
</span><a href="Numeric.Backprop.Internal.html#backpropWithN"><span class="hs-identifier hs-var">backpropWithN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZeroFunc a
</span><a href="#local-6989586621679149578"><span class="hs-identifier hs-var">zfa</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc a -&gt; Rec ZeroFunc '[] -&gt; Rec ZeroFunc '[a]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVar s a -&gt; BVar s b
forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b
</span><a href="#local-6989586621679149577"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(BVar s a -&gt; BVar s b)
-&gt; (Rec (BVar s) '[a] -&gt; BVar s a) -&gt; Rec (BVar s) '[a] -&gt; BVar s b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span id="local-6989586621679149575"><span class="annot"><span class="annottext">x :: BVar s r
</span><a href="#local-6989586621679149575"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RNil</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BVar s a
BVar s r
</span><a href="#local-6989586621679149575"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>                   </span><span class="annot"><span class="annottext">(Rec Identity '[a] -&gt; (b, b -&gt; Rec Identity '[a]))
-&gt; (a -&gt; Rec Identity '[a]) -&gt; a -&gt; (b, b -&gt; Rec Identity '[a])
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identity a -&gt; Rec Identity '[] -&gt; Rec Identity '[a]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rec Identity '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>                   </span><span class="annot"><span class="annottext">(Identity a -&gt; Rec Identity '[a])
-&gt; (a -&gt; Identity a) -&gt; a -&gt; Rec Identity '[a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Identity a
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span>
</span><span id="line-200"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#backpropWith"><span class="hs-pragma hs-type">backpropWith</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span class="hs-comment">-- | 'evalBP' but with no arguments.  Useful when everything is just given</span><span>
</span><span id="line-203"></span><span class="hs-comment">-- through 'constVar'.</span><span>
</span><span id="line-204"></span><span id="local-6989586621679149574"><span class="annot"><a href="Numeric.Backprop.Explicit.html#evalBP0"><span class="hs-identifier hs-type">evalBP0</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149932"><span class="annot"><a href="#local-6989586621679149932"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149932"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149932"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149574"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149574"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-205"></span><span id="evalBP0"><span class="annot"><span class="annottext">evalBP0 :: (forall s. Reifies s W =&gt; BVar s a) -&gt; a
</span><a href="Numeric.Backprop.Explicit.html#evalBP0"><span class="hs-identifier hs-var hs-var">evalBP0</span></a></span></span><span> </span><span id="local-6989586621679149573"><span class="annot"><span class="annottext">x :: forall s. Reifies s W =&gt; BVar s a
</span><a href="#local-6989586621679149573"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. Reifies s W =&gt; Rec (BVar s) '[] -&gt; BVar s a)
-&gt; Rec Identity '[] -&gt; a
forall (as :: [*]) b.
(forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as -&gt; b
</span><a href="Numeric.Backprop.Internal.html#evalBPN"><span class="hs-identifier hs-var">evalBPN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVar s a -&gt; Rec (BVar s) '[] -&gt; BVar s a
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">BVar s a
forall s. Reifies s W =&gt; BVar s a
</span><a href="#local-6989586621679149573"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Rec Identity '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span>
</span><span id="line-206"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#evalBP0"><span class="hs-pragma hs-type">evalBP0</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-207"></span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | Turn a function @'BVar' s a -&gt; 'BVar' s b@ into the function @a -&gt; b@</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- that it represents.</span><span>
</span><span id="line-210"></span><span class="hs-comment">--</span><span>
</span><span id="line-211"></span><span class="hs-comment">-- Benchmarks show that this should have virtually no overhead over</span><span>
</span><span id="line-212"></span><span class="hs-comment">-- directly writing a @a -&gt; b@. 'BVar' is, in this situation, a zero-cost</span><span>
</span><span id="line-213"></span><span class="hs-comment">-- abstraction, performance-wise.</span><span>
</span><span id="line-214"></span><span class="hs-comment">--</span><span>
</span><span id="line-215"></span><span class="hs-comment">-- See documentation of 'Numeric.Backprop.backprop' for more information.</span><span>
</span><span id="line-216"></span><span id="local-6989586621679149570"><span id="local-6989586621679149571"><span class="annot"><a href="Numeric.Backprop.Explicit.html#evalBP"><span class="hs-identifier hs-type">evalBP</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149924"><span class="annot"><a href="#local-6989586621679149924"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149924"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149924"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149571"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149924"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149570"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149571"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149570"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-217"></span><span id="evalBP"><span class="annot"><span class="annottext">evalBP :: (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b) -&gt; a -&gt; b
</span><a href="Numeric.Backprop.Explicit.html#evalBP"><span class="hs-identifier hs-var hs-var">evalBP</span></a></span></span><span> </span><span id="local-6989586621679149569"><span class="annot"><span class="annottext">f :: forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b
</span><a href="#local-6989586621679149569"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. Reifies s W =&gt; Rec (BVar s) '[a] -&gt; BVar s b)
-&gt; Rec Identity '[a] -&gt; b
forall (as :: [*]) b.
(forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as -&gt; b
</span><a href="Numeric.Backprop.Internal.html#evalBPN"><span class="hs-identifier hs-var">evalBPN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVar s a -&gt; BVar s b
forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b
</span><a href="#local-6989586621679149569"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">(BVar s a -&gt; BVar s b)
-&gt; (Rec (BVar s) '[a] -&gt; BVar s a) -&gt; Rec (BVar s) '[a] -&gt; BVar s b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span id="local-6989586621679149568"><span class="annot"><span class="annottext">x :: BVar s r
</span><a href="#local-6989586621679149568"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RNil</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BVar s a
BVar s r
</span><a href="#local-6989586621679149568"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Rec Identity '[a] -&gt; b) -&gt; (a -&gt; Rec Identity '[a]) -&gt; a -&gt; b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Identity a -&gt; Rec Identity '[] -&gt; Rec Identity '[a]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rec Identity '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span class="hs-special">)</span><span>  </span><span class="annot"><span class="annottext">(Identity a -&gt; Rec Identity '[a])
-&gt; (a -&gt; Identity a) -&gt; a -&gt; Rec Identity '[a]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Identity a
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span>
</span><span id="line-218"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#evalBP"><span class="hs-pragma hs-type">evalBP</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-219"></span><span>
</span><span id="line-220"></span><span class="hs-comment">-- | 'Numeric.Backprop.gradBP', but with explicit 'zero' and 'one'.</span><span>
</span><span id="line-221"></span><span id="local-6989586621679149566"><span id="local-6989586621679149567"><span class="annot"><a href="Numeric.Backprop.Explicit.html#gradBP"><span class="hs-identifier hs-type">gradBP</span></a></span><span>
</span><span id="line-222"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149567"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-223"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#OneFunc"><span class="hs-identifier hs-type">OneFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149566"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149917"><span class="annot"><a href="#local-6989586621679149917"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149917"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149917"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149567"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149917"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149566"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149567"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-226"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149567"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-227"></span><span id="gradBP"><span class="annot"><span class="annottext">gradBP :: ZeroFunc a
-&gt; OneFunc b
-&gt; (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b)
-&gt; a
-&gt; a
</span><a href="Numeric.Backprop.Explicit.html#gradBP"><span class="hs-identifier hs-var hs-var">gradBP</span></a></span></span><span> </span><span id="local-6989586621679149565"><span class="annot"><span class="annottext">zfa :: ZeroFunc a
</span><a href="#local-6989586621679149565"><span class="hs-identifier hs-var">zfa</span></a></span></span><span> </span><span id="local-6989586621679149564"><span class="annot"><span class="annottext">ofb :: OneFunc b
</span><a href="#local-6989586621679149564"><span class="hs-identifier hs-var">ofb</span></a></span></span><span> </span><span id="local-6989586621679149563"><span class="annot"><span class="annottext">f :: forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b
</span><a href="#local-6989586621679149563"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b, a) -&gt; a
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((b, a) -&gt; a) -&gt; (a -&gt; (b, a)) -&gt; a -&gt; a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ZeroFunc a
-&gt; OneFunc b
-&gt; (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b)
-&gt; a
-&gt; (b, a)
forall a b.
ZeroFunc a
-&gt; OneFunc b
-&gt; (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b)
-&gt; a
-&gt; (b, a)
</span><a href="Numeric.Backprop.Explicit.html#backprop"><span class="hs-identifier hs-var">backprop</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc a
</span><a href="#local-6989586621679149565"><span class="hs-identifier hs-var">zfa</span></a></span><span> </span><span class="annot"><span class="annottext">OneFunc b
</span><a href="#local-6989586621679149564"><span class="hs-identifier hs-var">ofb</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b
</span><a href="#local-6989586621679149563"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-228"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gradBP"><span class="hs-pragma hs-type">gradBP</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-comment">-- | 'Numeric.Backprop.gradBP', Nbut with explicit 'zero' and 'one'.</span><span>
</span><span id="line-231"></span><span id="local-6989586621679149561"><span id="local-6989586621679149562"><span class="annot"><a href="Numeric.Backprop.Explicit.html#gradBPN"><span class="hs-identifier hs-type">gradBPN</span></a></span><span>
</span><span id="line-232"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149562"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-233"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#OneFunc"><span class="hs-identifier hs-type">OneFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149561"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-234"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149910"><span class="annot"><a href="#local-6989586621679149910"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149910"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149910"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679149562"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149910"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149561"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><a href="#local-6989586621679149562"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-236"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><a href="#local-6989586621679149562"><span class="hs-keyword hs-type">as</span></a></span></span></span><span>
</span><span id="line-237"></span><span id="gradBPN"><span class="annot"><span class="annottext">gradBPN :: Rec ZeroFunc as
-&gt; OneFunc b
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; Rec Identity as
</span><a href="Numeric.Backprop.Explicit.html#gradBPN"><span class="hs-identifier hs-var hs-var">gradBPN</span></a></span></span><span> </span><span id="local-6989586621679149560"><span class="annot"><span class="annottext">zfas :: Rec ZeroFunc as
</span><a href="#local-6989586621679149560"><span class="hs-identifier hs-var">zfas</span></a></span></span><span> </span><span id="local-6989586621679149559"><span class="annot"><span class="annottext">ofb :: OneFunc b
</span><a href="#local-6989586621679149559"><span class="hs-identifier hs-var">ofb</span></a></span></span><span> </span><span id="local-6989586621679149558"><span class="annot"><span class="annottext">f :: forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b
</span><a href="#local-6989586621679149558"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(b, Rec Identity as) -&gt; Rec Identity as
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((b, Rec Identity as) -&gt; Rec Identity as)
-&gt; (Rec Identity as -&gt; (b, Rec Identity as))
-&gt; Rec Identity as
-&gt; Rec Identity as
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
-&gt; OneFunc b
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; (b, Rec Identity as)
forall (as :: [*]) b.
Rec ZeroFunc as
-&gt; OneFunc b
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; (b, Rec Identity as)
</span><a href="Numeric.Backprop.Explicit.html#backpropN"><span class="hs-identifier hs-var">backpropN</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
</span><a href="#local-6989586621679149560"><span class="hs-identifier hs-var">zfas</span></a></span><span> </span><span class="annot"><span class="annottext">OneFunc b
</span><a href="#local-6989586621679149559"><span class="hs-identifier hs-var">ofb</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b
</span><a href="#local-6989586621679149558"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-238"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gradBPN"><span class="hs-pragma hs-type">gradBPN</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="hs-comment">-- | 'Numeric.Backprop.backprop2', but with explicit 'zero' and 'one'.</span><span>
</span><span id="line-241"></span><span id="local-6989586621679149879"><span id="local-6989586621679149880"><span id="local-6989586621679149881"><span class="annot"><a href="Numeric.Backprop.Explicit.html#backprop2"><span class="hs-identifier hs-type">backprop2</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149881"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149880"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#OneFunc"><span class="hs-identifier hs-type">OneFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149879"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149906"><span class="annot"><a href="#local-6989586621679149906"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149906"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149906"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149881"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149906"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149880"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149906"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149879"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-246"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149881"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149880"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-248"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149879"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149881"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149880"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-249"></span><span id="backprop2"><span class="annot"><span class="annottext">backprop2 :: ZeroFunc a
-&gt; ZeroFunc b
-&gt; OneFunc c
-&gt; (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c)
-&gt; a
-&gt; b
-&gt; (c, (a, b))
</span><a href="Numeric.Backprop.Explicit.html#backprop2"><span class="hs-identifier hs-var hs-var">backprop2</span></a></span></span><span> </span><span id="local-6989586621679149557"><span class="annot"><span class="annottext">zfa :: ZeroFunc a
</span><a href="#local-6989586621679149557"><span class="hs-identifier hs-var">zfa</span></a></span></span><span> </span><span id="local-6989586621679149556"><span class="annot"><span class="annottext">zfb :: ZeroFunc b
</span><a href="#local-6989586621679149556"><span class="hs-identifier hs-var">zfb</span></a></span></span><span> </span><span id="local-6989586621679149555"><span class="annot"><span class="annottext">ofc :: OneFunc c
</span><a href="#local-6989586621679149555"><span class="hs-identifier hs-var">ofc</span></a></span></span><span> </span><span id="local-6989586621679149554"><span class="annot"><span class="annottext">f :: forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c
</span><a href="#local-6989586621679149554"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679149553"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679149553"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679149552"><span class="annot"><span class="annottext">y :: b
</span><a href="#local-6989586621679149552"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rec Identity '[a, b] -&gt; (a, b))
-&gt; (c, Rec Identity '[a, b]) -&gt; (c, (a, b))
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span id="local-6989586621679149551"><span class="annot"><a href="#local-6989586621679149551"><span class="hs-identifier hs-var">dx</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span id="local-6989586621679149550"><span class="annot"><a href="#local-6989586621679149550"><span class="hs-identifier hs-var">dy</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RNil</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149551"><span class="hs-identifier hs-var">dx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679149550"><span class="hs-identifier hs-var">dy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((c, Rec Identity '[a, b]) -&gt; (c, (a, b)))
-&gt; (c, Rec Identity '[a, b]) -&gt; (c, (a, b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-250"></span><span>    </span><span class="annot"><span class="annottext">Rec ZeroFunc '[a, b]
-&gt; OneFunc c
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) '[a, b] -&gt; BVar s c)
-&gt; Rec Identity '[a, b]
-&gt; (c, Rec Identity '[a, b])
forall (as :: [*]) b.
Rec ZeroFunc as
-&gt; OneFunc b
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; (b, Rec Identity as)
</span><a href="Numeric.Backprop.Explicit.html#backpropN"><span class="hs-identifier hs-var">backpropN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZeroFunc a
</span><a href="#local-6989586621679149557"><span class="hs-identifier hs-var">zfa</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc a -&gt; Rec ZeroFunc '[b] -&gt; Rec ZeroFunc '[a, b]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">ZeroFunc b
</span><a href="#local-6989586621679149556"><span class="hs-identifier hs-var">zfb</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc b -&gt; Rec ZeroFunc '[] -&gt; Rec ZeroFunc '[b]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OneFunc c
</span><a href="#local-6989586621679149555"><span class="hs-identifier hs-var">ofc</span></a></span><span>
</span><span id="line-251"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679149549"><span class="annot"><span class="annottext">x' :: BVar s r
</span><a href="#local-6989586621679149549"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149548"><span class="annot"><span class="annottext">y' :: BVar s r
</span><a href="#local-6989586621679149548"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RNil</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BVar s a -&gt; BVar s b -&gt; BVar s c
forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c
</span><a href="#local-6989586621679149554"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">BVar s a
BVar s r
</span><a href="#local-6989586621679149549"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">BVar s b
BVar s r
</span><a href="#local-6989586621679149548"><span class="hs-identifier hs-var">y'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Identity a
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149553"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Identity a -&gt; Rec Identity '[b] -&gt; Rec Identity '[a, b]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Identity b
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679149552"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Identity b -&gt; Rec Identity '[] -&gt; Rec Identity '[b]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rec Identity '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#backprop2"><span class="hs-pragma hs-type">backprop2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-254"></span><span>
</span><span id="line-255"></span><span class="hs-comment">-- | 'Numeric.Backprop.backpropWith2', but with explicit 'zero'.</span><span>
</span><span id="line-256"></span><span class="hs-comment">--</span><span>
</span><span id="line-257"></span><span class="hs-comment">-- Note that argument order changed in v0.2.4.</span><span>
</span><span id="line-258"></span><span class="hs-comment">--</span><span>
</span><span id="line-259"></span><span class="hs-comment">-- @since 0.2.0.0</span><span>
</span><span id="line-260"></span><span id="local-6989586621679149545"><span id="local-6989586621679149546"><span id="local-6989586621679149547"><span class="annot"><a href="Numeric.Backprop.Explicit.html#backpropWith2"><span class="hs-identifier hs-type">backpropWith2</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149547"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149546"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149897"><span class="annot"><a href="#local-6989586621679149897"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149897"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149897"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149547"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149897"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149546"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149897"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149545"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149547"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149546"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149545"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149545"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149547"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149546"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-267"></span><span id="backpropWith2"><span class="annot"><span class="annottext">backpropWith2 :: ZeroFunc a
-&gt; ZeroFunc b
-&gt; (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c)
-&gt; a
-&gt; b
-&gt; (c, c -&gt; (a, b))
</span><a href="Numeric.Backprop.Explicit.html#backpropWith2"><span class="hs-identifier hs-var hs-var">backpropWith2</span></a></span></span><span> </span><span id="local-6989586621679149544"><span class="annot"><span class="annottext">zfa :: ZeroFunc a
</span><a href="#local-6989586621679149544"><span class="hs-identifier hs-var">zfa</span></a></span></span><span> </span><span id="local-6989586621679149543"><span class="annot"><span class="annottext">zfb :: ZeroFunc b
</span><a href="#local-6989586621679149543"><span class="hs-identifier hs-var">zfb</span></a></span></span><span> </span><span id="local-6989586621679149542"><span class="annot"><span class="annottext">f :: forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c
</span><a href="#local-6989586621679149542"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679149541"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679149541"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679149540"><span class="annot"><span class="annottext">y :: b
</span><a href="#local-6989586621679149540"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((c -&gt; Rec Identity '[a, b]) -&gt; c -&gt; (a, b))
-&gt; (c, c -&gt; Rec Identity '[a, b]) -&gt; (c, c -&gt; (a, b))
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><span class="hs-identifier hs-var">second</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span id="local-6989586621679149539"><span class="annot"><a href="#local-6989586621679149539"><span class="hs-identifier hs-var">dx</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span id="local-6989586621679149538"><span class="annot"><a href="#local-6989586621679149538"><span class="hs-identifier hs-var">dy</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RNil</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149539"><span class="hs-identifier hs-var">dx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679149538"><span class="hs-identifier hs-var">dy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Rec Identity '[a, b] -&gt; (a, b))
-&gt; (c -&gt; Rec Identity '[a, b]) -&gt; c -&gt; (a, b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((c, c -&gt; Rec Identity '[a, b]) -&gt; (c, c -&gt; (a, b)))
-&gt; (c, c -&gt; Rec Identity '[a, b]) -&gt; (c, c -&gt; (a, b))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><span class="annottext">Rec ZeroFunc '[a, b]
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) '[a, b] -&gt; BVar s c)
-&gt; Rec Identity '[a, b]
-&gt; (c, c -&gt; Rec Identity '[a, b])
forall (as :: [*]) b.
Rec ZeroFunc as
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; (b, b -&gt; Rec Identity as)
</span><a href="Numeric.Backprop.Internal.html#backpropWithN"><span class="hs-identifier hs-var">backpropWithN</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ZeroFunc a
</span><a href="#local-6989586621679149544"><span class="hs-identifier hs-var">zfa</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc a -&gt; Rec ZeroFunc '[b] -&gt; Rec ZeroFunc '[a, b]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">ZeroFunc b
</span><a href="#local-6989586621679149543"><span class="hs-identifier hs-var">zfb</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc b -&gt; Rec ZeroFunc '[] -&gt; Rec ZeroFunc '[b]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679149537"><span class="annot"><span class="annottext">x' :: BVar s r
</span><a href="#local-6989586621679149537"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149536"><span class="annot"><span class="annottext">y' :: BVar s r
</span><a href="#local-6989586621679149536"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RNil</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BVar s a -&gt; BVar s b -&gt; BVar s c
forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c
</span><a href="#local-6989586621679149542"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">BVar s a
BVar s r
</span><a href="#local-6989586621679149537"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">BVar s b
BVar s r
</span><a href="#local-6989586621679149536"><span class="hs-identifier hs-var">y'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Identity a
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149541"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Identity a -&gt; Rec Identity '[b] -&gt; Rec Identity '[a, b]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Identity b
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679149540"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Identity b -&gt; Rec Identity '[] -&gt; Rec Identity '[b]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rec Identity '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#backpropWith2"><span class="hs-pragma hs-type">backpropWith2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span class="hs-comment">-- | 'evalBP' for a two-argument function.  See</span><span>
</span><span id="line-274"></span><span class="hs-comment">-- 'Numeric.Backprop.backprop2' for notes.</span><span>
</span><span id="line-275"></span><span id="local-6989586621679149533"><span id="local-6989586621679149534"><span id="local-6989586621679149535"><span class="annot"><a href="Numeric.Backprop.Explicit.html#evalBP2"><span class="hs-identifier hs-type">evalBP2</span></a></span><span>
</span><span id="line-276"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149892"><span class="annot"><a href="#local-6989586621679149892"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149892"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149892"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149535"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149892"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149534"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149892"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149533"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149535"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149534"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149533"><span class="hs-identifier hs-type">c</span></a></span></span></span></span><span>
</span><span id="line-280"></span><span id="evalBP2"><span class="annot"><span class="annottext">evalBP2 :: (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c)
-&gt; a -&gt; b -&gt; c
</span><a href="Numeric.Backprop.Explicit.html#evalBP2"><span class="hs-identifier hs-var hs-var">evalBP2</span></a></span></span><span> </span><span id="local-6989586621679149532"><span class="annot"><span class="annottext">f :: forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c
</span><a href="#local-6989586621679149532"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679149531"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679149531"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679149530"><span class="annot"><span class="annottext">y :: b
</span><a href="#local-6989586621679149530"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall s. Reifies s W =&gt; Rec (BVar s) '[a, b] -&gt; BVar s c)
-&gt; Rec Identity '[a, b] -&gt; c
forall (as :: [*]) b.
(forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as -&gt; b
</span><a href="Numeric.Backprop.Internal.html#evalBPN"><span class="hs-identifier hs-var">evalBPN</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679149529"><span class="annot"><span class="annottext">x' :: BVar s r
</span><a href="#local-6989586621679149529"><span class="hs-identifier hs-var">x'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149528"><span class="annot"><span class="annottext">y' :: BVar s r
</span><a href="#local-6989586621679149528"><span class="hs-identifier hs-var">y'</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">RNil</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BVar s a -&gt; BVar s b -&gt; BVar s c
forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c
</span><a href="#local-6989586621679149532"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">BVar s a
BVar s r
</span><a href="#local-6989586621679149529"><span class="hs-identifier hs-var">x'</span></a></span><span> </span><span class="annot"><span class="annottext">BVar s b
BVar s r
</span><a href="#local-6989586621679149528"><span class="hs-identifier hs-var">y'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Rec Identity '[a, b] -&gt; c) -&gt; Rec Identity '[a, b] -&gt; c
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Identity a
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149531"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-281"></span><span>                                                        </span><span class="annot"><span class="annottext">Identity a -&gt; Rec Identity '[b] -&gt; Rec Identity '[a, b]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">b -&gt; Identity b
forall a. a -&gt; Identity a
</span><span class="hs-identifier hs-var">Identity</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679149530"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-282"></span><span>                                                        </span><span class="annot"><span class="annottext">Identity b -&gt; Rec Identity '[] -&gt; Rec Identity '[b]
forall u (a :: u -&gt; *) (r :: u) (rs :: [u]).
a r -&gt; Rec a rs -&gt; Rec a (r : rs)
</span><span class="hs-operator hs-var">:&amp;</span></span><span> </span><span class="annot"><span class="annottext">Rec Identity '[]
forall u (a :: u -&gt; *). Rec a '[]
</span><span class="hs-identifier hs-var">RNil</span></span><span>
</span><span id="line-283"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#evalBP2"><span class="hs-pragma hs-type">evalBP2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-284"></span><span>
</span><span id="line-285"></span><span class="hs-comment">-- | 'Numeric.Backprop.gradBP2' with explicit 'zero' and 'one'.</span><span>
</span><span id="line-286"></span><span id="local-6989586621679149525"><span id="local-6989586621679149526"><span id="local-6989586621679149527"><span class="annot"><a href="Numeric.Backprop.Explicit.html#gradBP2"><span class="hs-identifier hs-type">gradBP2</span></a></span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149527"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149526"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#OneFunc"><span class="hs-identifier hs-type">OneFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149525"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149882"><span class="annot"><a href="#local-6989586621679149882"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149882"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149882"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149527"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149882"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149526"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149882"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149525"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149527"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149526"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149527"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149526"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-294"></span><span id="gradBP2"><span class="annot"><span class="annottext">gradBP2 :: ZeroFunc a
-&gt; ZeroFunc b
-&gt; OneFunc c
-&gt; (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c)
-&gt; a
-&gt; b
-&gt; (a, b)
</span><a href="Numeric.Backprop.Explicit.html#gradBP2"><span class="hs-identifier hs-var hs-var">gradBP2</span></a></span></span><span> </span><span id="local-6989586621679149524"><span class="annot"><span class="annottext">zfa :: ZeroFunc a
</span><a href="#local-6989586621679149524"><span class="hs-identifier hs-var">zfa</span></a></span></span><span> </span><span id="local-6989586621679149523"><span class="annot"><span class="annottext">zfb :: ZeroFunc b
</span><a href="#local-6989586621679149523"><span class="hs-identifier hs-var">zfb</span></a></span></span><span> </span><span id="local-6989586621679149522"><span class="annot"><span class="annottext">ofc :: OneFunc c
</span><a href="#local-6989586621679149522"><span class="hs-identifier hs-var">ofc</span></a></span></span><span> </span><span id="local-6989586621679149521"><span class="annot"><span class="annottext">f :: forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c
</span><a href="#local-6989586621679149521"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679149520"><span class="annot"><span class="annottext">x :: a
</span><a href="#local-6989586621679149520"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(c, (a, b)) -&gt; (a, b)
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span> </span><span class="annot"><span class="annottext">((c, (a, b)) -&gt; (a, b)) -&gt; (b -&gt; (c, (a, b))) -&gt; b -&gt; (a, b)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">ZeroFunc a
-&gt; ZeroFunc b
-&gt; OneFunc c
-&gt; (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c)
-&gt; a
-&gt; b
-&gt; (c, (a, b))
forall a b c.
ZeroFunc a
-&gt; ZeroFunc b
-&gt; OneFunc c
-&gt; (forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c)
-&gt; a
-&gt; b
-&gt; (c, (a, b))
</span><a href="Numeric.Backprop.Explicit.html#backprop2"><span class="hs-identifier hs-var">backprop2</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc a
</span><a href="#local-6989586621679149524"><span class="hs-identifier hs-var">zfa</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc b
</span><a href="#local-6989586621679149523"><span class="hs-identifier hs-var">zfb</span></a></span><span> </span><span class="annot"><span class="annottext">OneFunc c
</span><a href="#local-6989586621679149522"><span class="hs-identifier hs-var">ofc</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Reifies s W =&gt; BVar s a -&gt; BVar s b -&gt; BVar s c
</span><a href="#local-6989586621679149521"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679149520"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-295"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gradBP2"><span class="hs-pragma hs-type">gradBP2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- | 'Numeric.Backprop.bpOp' with explicit 'zero'.</span><span>
</span><span id="line-298"></span><span id="local-6989586621679149518"><span id="local-6989586621679149519"><span class="annot"><a href="Numeric.Backprop.Explicit.html#bpOp"><span class="hs-identifier hs-type">bpOp</span></a></span><span>
</span><span id="line-299"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149519"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149877"><span class="annot"><a href="#local-6989586621679149877"><span class="hs-identifier hs-type">s</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149877"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149877"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679149519"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149877"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149518"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-301"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Op.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149519"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149518"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-302"></span><span id="bpOp"><span class="annot"><span class="annottext">bpOp :: Rec ZeroFunc as
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Op as b
</span><a href="Numeric.Backprop.Explicit.html#bpOp"><span class="hs-identifier hs-var hs-var">bpOp</span></a></span></span><span> </span><span id="local-6989586621679149517"><span class="annot"><span class="annottext">zfs :: Rec ZeroFunc as
</span><a href="#local-6989586621679149517"><span class="hs-identifier hs-var">zfs</span></a></span></span><span> </span><span id="local-6989586621679149516"><span class="annot"><span class="annottext">f :: forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b
</span><a href="#local-6989586621679149516"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Rec Identity as -&gt; (b, b -&gt; Rec Identity as)) -&gt; Op as b
forall (as :: [*]) a.
(Rec Identity as -&gt; (a, a -&gt; Rec Identity as)) -&gt; Op as a
</span><a href="Numeric.Backprop.Op.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec ZeroFunc as
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; (b, b -&gt; Rec Identity as)
forall (as :: [*]) b.
Rec ZeroFunc as
-&gt; (forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b)
-&gt; Rec Identity as
-&gt; (b, b -&gt; Rec Identity as)
</span><a href="Numeric.Backprop.Internal.html#backpropWithN"><span class="hs-identifier hs-var">backpropWithN</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
</span><a href="#local-6989586621679149517"><span class="hs-identifier hs-var">zfs</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Reifies s W =&gt; Rec (BVar s) as -&gt; BVar s b
</span><a href="#local-6989586621679149516"><span class="hs-identifier hs-var">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#bpOp"><span class="hs-pragma hs-type">bpOp</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-304"></span><span>
</span><span id="line-305"></span><span class="hs-comment">-- | 'Numeric.Backprop.overVar' with explicit 'add' and 'zero'.</span><span>
</span><span id="line-306"></span><span class="hs-comment">--</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- @since 0.2.4.0</span><span>
</span><span id="line-308"></span><span id="local-6989586621679149512"><span id="local-6989586621679149513"><span id="local-6989586621679149514"><span class="annot"><a href="Numeric.Backprop.Explicit.html#overVar"><span class="hs-identifier hs-type">overVar</span></a></span><span>
</span><span id="line-309"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149514"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span>
</span><span id="line-310"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149513"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-311"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149512"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-312"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149513"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149512"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679149512"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149513"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149514"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149513"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149514"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149513"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149514"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149512"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149514"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149512"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-318"></span><span id="overVar"><span class="annot"><span class="annottext">overVar :: AddFunc a
-&gt; AddFunc b
-&gt; ZeroFunc a
-&gt; ZeroFunc b
-&gt; Lens' b a
-&gt; (BVar s a -&gt; BVar s a)
-&gt; BVar s b
-&gt; BVar s b
</span><a href="Numeric.Backprop.Explicit.html#overVar"><span class="hs-identifier hs-var hs-var">overVar</span></a></span></span><span> </span><span id="local-6989586621679149511"><span class="annot"><span class="annottext">afa :: AddFunc a
</span><a href="#local-6989586621679149511"><span class="hs-identifier hs-var">afa</span></a></span></span><span> </span><span id="local-6989586621679149510"><span class="annot"><span class="annottext">afb :: AddFunc b
</span><a href="#local-6989586621679149510"><span class="hs-identifier hs-var">afb</span></a></span></span><span> </span><span id="local-6989586621679149509"><span class="annot"><span class="annottext">zfa :: ZeroFunc a
</span><a href="#local-6989586621679149509"><span class="hs-identifier hs-var">zfa</span></a></span></span><span> </span><span id="local-6989586621679149508"><span class="annot"><span class="annottext">zfb :: ZeroFunc b
</span><a href="#local-6989586621679149508"><span class="hs-identifier hs-var">zfb</span></a></span></span><span> </span><span id="local-6989586621679149507"><span class="annot"><span class="annottext">l :: Lens' b a
</span><a href="#local-6989586621679149507"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679149506"><span class="annot"><span class="annottext">f :: BVar s a -&gt; BVar s a
</span><a href="#local-6989586621679149506"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679149505"><span class="annot"><span class="annottext">x :: BVar s b
</span><a href="#local-6989586621679149505"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddFunc a
-&gt; AddFunc b
-&gt; ZeroFunc a
-&gt; Lens' b a
-&gt; BVar s a
-&gt; BVar s b
-&gt; BVar s b
forall a b s.
Reifies s W =&gt;
AddFunc a
-&gt; AddFunc b
-&gt; ZeroFunc a
-&gt; Lens' b a
-&gt; BVar s a
-&gt; BVar s b
-&gt; BVar s b
</span><a href="Numeric.Backprop.Internal.html#setVar"><span class="hs-identifier hs-var">setVar</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc a
</span><a href="#local-6989586621679149511"><span class="hs-identifier hs-var">afa</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc b
</span><a href="#local-6989586621679149510"><span class="hs-identifier hs-var">afb</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc a
</span><a href="#local-6989586621679149509"><span class="hs-identifier hs-var">zfa</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' b a
</span><a href="#local-6989586621679149507"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BVar s a -&gt; BVar s a
</span><a href="#local-6989586621679149506"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AddFunc a -&gt; ZeroFunc b -&gt; Lens' b a -&gt; BVar s b -&gt; BVar s a
forall a b s.
Reifies s W =&gt;
AddFunc a -&gt; ZeroFunc b -&gt; Lens' b a -&gt; BVar s b -&gt; BVar s a
</span><a href="Numeric.Backprop.Internal.html#viewVar"><span class="hs-identifier hs-var">viewVar</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc a
</span><a href="#local-6989586621679149511"><span class="hs-identifier hs-var">afa</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc b
</span><a href="#local-6989586621679149508"><span class="hs-identifier hs-var">zfb</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' b a
</span><a href="#local-6989586621679149507"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="annot"><span class="annottext">BVar s b
</span><a href="#local-6989586621679149505"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">BVar s b
</span><a href="#local-6989586621679149505"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-319"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#overVar"><span class="hs-pragma hs-type">overVar</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="hs-comment">-- | 'Numeric.Backprop.isoVar' with explicit 'add' and 'zero'.</span><span>
</span><span id="line-322"></span><span id="local-6989586621679149502"><span id="local-6989586621679149503"><span id="local-6989586621679149504"><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVar"><span class="hs-identifier hs-type">isoVar</span></a></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149504"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span>
</span><span id="line-324"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149503"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149503"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149502"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149502"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149503"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149504"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149503"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-328"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149504"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149502"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-329"></span><span id="isoVar"><span class="annot"><span class="annottext">isoVar :: AddFunc a -&gt; (a -&gt; b) -&gt; (b -&gt; a) -&gt; BVar s a -&gt; BVar s b
</span><a href="Numeric.Backprop.Explicit.html#isoVar"><span class="hs-identifier hs-var hs-var">isoVar</span></a></span></span><span> </span><span id="local-6989586621679149501"><span class="annot"><span class="annottext">af :: AddFunc a
</span><a href="#local-6989586621679149501"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621679149500"><span class="annot"><span class="annottext">f :: a -&gt; b
</span><a href="#local-6989586621679149500"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679149499"><span class="annot"><span class="annottext">g :: b -&gt; a
</span><a href="#local-6989586621679149499"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddFunc a -&gt; Op '[a] b -&gt; BVar s a -&gt; BVar s b
forall a b s.
Reifies s W =&gt;
AddFunc a -&gt; Op '[a] b -&gt; BVar s a -&gt; BVar s b
</span><a href="Numeric.Backprop.Internal.html#liftOp1"><span class="hs-identifier hs-var">liftOp1</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc a
</span><a href="#local-6989586621679149501"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; (b -&gt; a) -&gt; Op '[a] b
forall a b. (a -&gt; b) -&gt; (b -&gt; a) -&gt; Op '[a] b
</span><a href="Numeric.Backprop.Op.html#opIso"><span class="hs-identifier hs-var">opIso</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679149500"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; a
</span><a href="#local-6989586621679149499"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-330"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVar"><span class="hs-pragma hs-type">isoVar</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-331"></span><span>
</span><span id="line-332"></span><span class="hs-comment">-- | 'Numeric.Backprop.isoVar2' with explicit 'add' and 'zero'.</span><span>
</span><span id="line-333"></span><span id="local-6989586621679149740"><span id="local-6989586621679149741"><span id="local-6989586621679149742"><span id="local-6989586621679149743"><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVar2"><span class="hs-identifier hs-type">isoVar2</span></a></span><span>
</span><span id="line-334"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149743"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span>
</span><span id="line-335"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149742"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-336"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149741"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149742"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149741"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149740"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149740"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149742"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149741"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149743"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149742"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149743"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149741"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149743"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149740"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span><span>
</span><span id="line-342"></span><span id="isoVar2"><span class="annot"><span class="annottext">isoVar2 :: AddFunc a
-&gt; AddFunc b
-&gt; (a -&gt; b -&gt; c)
-&gt; (c -&gt; (a, b))
-&gt; BVar s a
-&gt; BVar s b
-&gt; BVar s c
</span><a href="Numeric.Backprop.Explicit.html#isoVar2"><span class="hs-identifier hs-var hs-var">isoVar2</span></a></span></span><span> </span><span id="local-6989586621679149498"><span class="annot"><span class="annottext">afa :: AddFunc a
</span><a href="#local-6989586621679149498"><span class="hs-identifier hs-var">afa</span></a></span></span><span> </span><span id="local-6989586621679149497"><span class="annot"><span class="annottext">afb :: AddFunc b
</span><a href="#local-6989586621679149497"><span class="hs-identifier hs-var">afb</span></a></span></span><span> </span><span id="local-6989586621679149496"><span class="annot"><span class="annottext">f :: a -&gt; b -&gt; c
</span><a href="#local-6989586621679149496"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679149495"><span class="annot"><span class="annottext">g :: c -&gt; (a, b)
</span><a href="#local-6989586621679149495"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddFunc a
-&gt; AddFunc b -&gt; Op '[a, b] c -&gt; BVar s a -&gt; BVar s b -&gt; BVar s c
forall a b c s.
Reifies s W =&gt;
AddFunc a
-&gt; AddFunc b -&gt; Op '[a, b] c -&gt; BVar s a -&gt; BVar s b -&gt; BVar s c
</span><a href="Numeric.Backprop.Internal.html#liftOp2"><span class="hs-identifier hs-var">liftOp2</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc a
</span><a href="#local-6989586621679149498"><span class="hs-identifier hs-var">afa</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc b
</span><a href="#local-6989586621679149497"><span class="hs-identifier hs-var">afb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; c) -&gt; (c -&gt; (a, b)) -&gt; Op '[a, b] c
forall a b c. (a -&gt; b -&gt; c) -&gt; (c -&gt; (a, b)) -&gt; Op '[a, b] c
</span><a href="Numeric.Backprop.Op.html#opIso2"><span class="hs-identifier hs-var">opIso2</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c
</span><a href="#local-6989586621679149496"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">c -&gt; (a, b)
</span><a href="#local-6989586621679149495"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVar2"><span class="hs-pragma hs-type">isoVar2</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-344"></span><span>
</span><span id="line-345"></span><span class="hs-comment">-- | 'Numeric.Backprop.isoVar3' with explicit 'add' and 'zero'.</span><span>
</span><span id="line-346"></span><span id="local-6989586621679149489"><span id="local-6989586621679149490"><span id="local-6989586621679149491"><span id="local-6989586621679149492"><span id="local-6989586621679149493"><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVar3"><span class="hs-identifier hs-type">isoVar3</span></a></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149493"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149492"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-349"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149491"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149490"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-351"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149492"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149491"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149490"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149489"><span class="hs-identifier hs-type">d</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149489"><span class="hs-identifier hs-type">d</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149492"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149491"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149490"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149493"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149492"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149493"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149491"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-355"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149493"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149490"><span class="hs-identifier hs-type">c</span></a></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149493"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149489"><span class="hs-identifier hs-type">d</span></a></span></span></span></span></span></span><span>
</span><span id="line-357"></span><span id="isoVar3"><span class="annot"><span class="annottext">isoVar3 :: AddFunc a
-&gt; AddFunc b
-&gt; AddFunc c
-&gt; (a -&gt; b -&gt; c -&gt; d)
-&gt; (d -&gt; (a, b, c))
-&gt; BVar s a
-&gt; BVar s b
-&gt; BVar s c
-&gt; BVar s d
</span><a href="Numeric.Backprop.Explicit.html#isoVar3"><span class="hs-identifier hs-var hs-var">isoVar3</span></a></span></span><span> </span><span id="local-6989586621679149488"><span class="annot"><span class="annottext">afa :: AddFunc a
</span><a href="#local-6989586621679149488"><span class="hs-identifier hs-var">afa</span></a></span></span><span> </span><span id="local-6989586621679149487"><span class="annot"><span class="annottext">afb :: AddFunc b
</span><a href="#local-6989586621679149487"><span class="hs-identifier hs-var">afb</span></a></span></span><span> </span><span id="local-6989586621679149486"><span class="annot"><span class="annottext">afc :: AddFunc c
</span><a href="#local-6989586621679149486"><span class="hs-identifier hs-var">afc</span></a></span></span><span> </span><span id="local-6989586621679149485"><span class="annot"><span class="annottext">f :: a -&gt; b -&gt; c -&gt; d
</span><a href="#local-6989586621679149485"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679149484"><span class="annot"><span class="annottext">g :: d -&gt; (a, b, c)
</span><a href="#local-6989586621679149484"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddFunc a
-&gt; AddFunc b
-&gt; AddFunc c
-&gt; Op '[a, b, c] d
-&gt; BVar s a
-&gt; BVar s b
-&gt; BVar s c
-&gt; BVar s d
forall a b c d s.
Reifies s W =&gt;
AddFunc a
-&gt; AddFunc b
-&gt; AddFunc c
-&gt; Op '[a, b, c] d
-&gt; BVar s a
-&gt; BVar s b
-&gt; BVar s c
-&gt; BVar s d
</span><a href="Numeric.Backprop.Internal.html#liftOp3"><span class="hs-identifier hs-var">liftOp3</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc a
</span><a href="#local-6989586621679149488"><span class="hs-identifier hs-var">afa</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc b
</span><a href="#local-6989586621679149487"><span class="hs-identifier hs-var">afb</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc c
</span><a href="#local-6989586621679149486"><span class="hs-identifier hs-var">afc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(a -&gt; b -&gt; c -&gt; d) -&gt; (d -&gt; (a, b, c)) -&gt; Op '[a, b, c] d
forall a b c d.
(a -&gt; b -&gt; c -&gt; d) -&gt; (d -&gt; (a, b, c)) -&gt; Op '[a, b, c] d
</span><a href="Numeric.Backprop.Op.html#opIso3"><span class="hs-identifier hs-var">opIso3</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b -&gt; c -&gt; d
</span><a href="#local-6989586621679149485"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">d -&gt; (a, b, c)
</span><a href="#local-6989586621679149484"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-358"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVar3"><span class="hs-pragma hs-type">isoVar3</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-359"></span><span>
</span><span id="line-360"></span><span class="hs-comment">-- | 'Numeric.Backprop.isoVarN' with explicit 'add' and 'zero'.</span><span>
</span><span id="line-361"></span><span id="local-6989586621679149480"><span id="local-6989586621679149481"><span id="local-6989586621679149482"><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVarN"><span class="hs-identifier hs-type">isoVarN</span></a></span><span>
</span><span id="line-362"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149482"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149481"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-364"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><a href="#local-6989586621679149481"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149480"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149480"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Identity</span></span><span> </span><span class="annot"><a href="#local-6989586621679149481"><span class="hs-keyword hs-type">as</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-366"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149482"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679149481"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-367"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149482"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149480"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-368"></span><span id="isoVarN"><span class="annot"><span class="annottext">isoVarN :: Rec AddFunc as
-&gt; (Rec Identity as -&gt; b)
-&gt; (b -&gt; Rec Identity as)
-&gt; Rec (BVar s) as
-&gt; BVar s b
</span><a href="Numeric.Backprop.Explicit.html#isoVarN"><span class="hs-identifier hs-var hs-var">isoVarN</span></a></span></span><span> </span><span id="local-6989586621679149479"><span class="annot"><span class="annottext">afs :: Rec AddFunc as
</span><a href="#local-6989586621679149479"><span class="hs-identifier hs-var">afs</span></a></span></span><span> </span><span id="local-6989586621679149478"><span class="annot"><span class="annottext">f :: Rec Identity as -&gt; b
</span><a href="#local-6989586621679149478"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679149477"><span class="annot"><span class="annottext">g :: b -&gt; Rec Identity as
</span><a href="#local-6989586621679149477"><span class="hs-identifier hs-var">g</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as -&gt; Op as b -&gt; Rec (BVar s) as -&gt; BVar s b
forall (as :: [*]) b s.
Reifies s W =&gt;
Rec AddFunc as -&gt; Op as b -&gt; Rec (BVar s) as -&gt; BVar s b
</span><a href="Numeric.Backprop.Internal.html#liftOp"><span class="hs-identifier hs-var">liftOp</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as
</span><a href="#local-6989586621679149479"><span class="hs-identifier hs-var">afs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rec Identity as -&gt; b) -&gt; (b -&gt; Rec Identity as) -&gt; Op as b
forall (as :: [*]) b.
(Rec Identity as -&gt; b) -&gt; (b -&gt; Rec Identity as) -&gt; Op as b
</span><a href="Numeric.Backprop.Op.html#opIsoN"><span class="hs-identifier hs-var">opIsoN</span></a></span><span> </span><span class="annot"><span class="annottext">Rec Identity as -&gt; b
</span><a href="#local-6989586621679149478"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">b -&gt; Rec Identity as
</span><a href="#local-6989586621679149477"><span class="hs-identifier hs-var">g</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#isoVarN"><span class="hs-pragma hs-type">isoVarN</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-370"></span><span>
</span><span id="line-371"></span><span class="hs-comment">-- | Helper class for generically &quot;splitting&quot; and &quot;joining&quot; 'BVar's into</span><span>
</span><span id="line-372"></span><span class="hs-comment">-- constructors.  See 'Numeric.Backprop.splitBV' and</span><span>
</span><span id="line-373"></span><span class="hs-comment">-- 'Numeric.Backprop.joinBV'.</span><span>
</span><span id="line-374"></span><span class="hs-comment">--</span><span>
</span><span id="line-375"></span><span class="hs-comment">-- See &quot;Numeric.Backprop#hkd&quot; for a tutorial on how to use this.</span><span>
</span><span id="line-376"></span><span class="hs-comment">--</span><span>
</span><span id="line-377"></span><span class="hs-comment">-- Instances should be available for types made with one constructor whose</span><span>
</span><span id="line-378"></span><span class="hs-comment">-- fields are all instances of 'Backprop', with a 'Generic' instance.</span><span>
</span><span id="line-379"></span><span class="hs-comment">--</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- @since 0.2.2.0</span><span>
</span><span id="line-381"></span><span class="hs-keyword">class</span><span> </span><span id="BVGroup"><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-var">BVGroup</span></a></span></span><span> </span><span id="local-6989586621679149816"><span class="annot"><a href="#local-6989586621679149816"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679149817"><span class="annot"><a href="#local-6989586621679149817"><span class="hs-keyword hs-type">as</span></a></span></span><span> </span><span id="local-6989586621679149815"><span class="annot"><a href="#local-6989586621679149815"><span class="hs-identifier hs-type">i</span></a></span></span><span> </span><span id="local-6989586621679149814"><span class="annot"><a href="#local-6989586621679149814"><span class="hs-identifier hs-type">o</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><a href="#local-6989586621679149814"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149815"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149815"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149817"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-382"></span><span>    </span><span class="hs-comment">-- | Helper method for generically &quot;splitting&quot; 'BVar's out of</span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-comment">-- constructors inside a 'BVar'.  See 'splitBV'.</span><span>
</span><span id="line-384"></span><span>    </span><span id="gsplitBV"><span class="annot"><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-identifier hs-type">gsplitBV</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149817"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149817"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149816"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149815"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149814"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-comment">-- | Helper method for generically &quot;joining&quot; 'BVar's inside</span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-comment">-- a constructor into a 'BVar'.  See 'joinBV'.</span><span>
</span><span id="line-387"></span><span>    </span><span id="gjoinBV"><span class="annot"><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-identifier hs-type">gjoinBV</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149817"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149817"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149814"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149816"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149815"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span id="local-6989586621679149472"><span id="local-6989586621679149473"><span id="local-6989586621679149474"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149474"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679149473"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149472"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">K1</span></span><span> </span><span class="annot"><a href="#local-6989586621679149473"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149474"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149472"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-390"></span><span>    </span><span id="local-6989586621679149468"><span class="annot"><span class="annottext">gsplitBV :: Rec AddFunc '[]
-&gt; Rec ZeroFunc '[] -&gt; BVar s (K1 i a ()) -&gt; K1 i (BVar s a) ()
</span><a href="#local-6989586621679149468"><span class="hs-identifier hs-var hs-var hs-var hs-var">gsplitBV</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BVar s a -&gt; K1 i (BVar s a) ()
forall k i c (p :: k). c -&gt; K1 i c p
</span><span class="hs-identifier hs-var">K1</span></span><span> </span><span class="annot"><span class="annottext">(BVar s a -&gt; K1 i (BVar s a) ())
-&gt; (BVar s (K1 i a ()) -&gt; BVar s a)
-&gt; BVar s (K1 i a ())
-&gt; K1 i (BVar s a) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BVar s (K1 i a ()) -&gt; BVar s a
forall a b s. Coercible a b =&gt; BVar s a -&gt; BVar s b
</span><a href="Numeric.Backprop.Internal.html#coerceVar"><span class="hs-identifier hs-var">coerceVar</span></a></span><span>
</span><span id="line-391"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-pragma hs-type">gsplitBV</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-392"></span><span>    </span><span id="local-6989586621679149466"><span class="annot"><span class="annottext">gjoinBV :: Rec AddFunc '[]
-&gt; Rec ZeroFunc '[] -&gt; K1 i (BVar s a) () -&gt; BVar s (K1 i a ())
</span><a href="#local-6989586621679149466"><span class="hs-identifier hs-var hs-var hs-var hs-var">gjoinBV</span></a></span></span><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BVar s a -&gt; BVar s (K1 i a ())
forall a b s. Coercible a b =&gt; BVar s a -&gt; BVar s b
</span><a href="Numeric.Backprop.Internal.html#coerceVar"><span class="hs-identifier hs-var">coerceVar</span></a></span><span> </span><span class="annot"><span class="annottext">(BVar s a -&gt; BVar s (K1 i a ()))
-&gt; (K1 i (BVar s a) () -&gt; BVar s a)
-&gt; K1 i (BVar s a) ()
-&gt; BVar s (K1 i a ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">K1 i (BVar s a) () -&gt; BVar s a
forall i c k (p :: k). K1 i c p -&gt; c
</span><span class="hs-identifier hs-var hs-var">unK1</span></span><span>
</span><span id="line-393"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-pragma hs-type">gjoinBV</span></a></span><span> </span><span class="hs-pragma">#-}</span></span></span></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span id="local-6989586621679149459"><span id="local-6989586621679149460"><span id="local-6989586621679149461"><span id="local-6989586621679149462"><span id="local-6989586621679149463"><span id="local-6989586621679149464"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149464"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149463"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149462"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149461"><span class="hs-identifier hs-type">o</span></a></span><span>
</span><span id="line-396"></span><span>        </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149464"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149463"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679149460"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149459"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149462"><span class="hs-identifier hs-type">i</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">M1</span></span><span> </span><span class="annot"><a href="#local-6989586621679149460"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149459"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149461"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-397"></span><span>    </span><span id="local-6989586621679149456"><span class="annot"><span class="annottext">gsplitBV :: Rec AddFunc as
-&gt; Rec ZeroFunc as -&gt; BVar s (M1 p c i ()) -&gt; M1 p c o ()
</span><a href="#local-6989586621679149456"><span class="hs-identifier hs-var hs-var hs-var hs-var">gsplitBV</span></a></span></span><span> </span><span id="local-6989586621679149455"><span class="annot"><span class="annottext">afs :: Rec AddFunc as
</span><a href="#local-6989586621679149455"><span class="hs-identifier hs-var">afs</span></a></span></span><span> </span><span id="local-6989586621679149454"><span class="annot"><span class="annottext">zfs :: Rec ZeroFunc as
</span><a href="#local-6989586621679149454"><span class="hs-identifier hs-var">zfs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">o () -&gt; M1 p c o ()
forall k i (c :: Meta) (f :: k -&gt; *) (p :: k). f p -&gt; M1 i c f p
</span><span class="hs-identifier hs-var">M1</span></span><span> </span><span class="annot"><span class="annottext">(o () -&gt; M1 p c o ())
-&gt; (BVar s (M1 p c i ()) -&gt; o ())
-&gt; BVar s (M1 p c i ())
-&gt; M1 p c o ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; BVar s (i ()) -&gt; o ()
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; BVar s (i ()) -&gt; o ()
</span><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-identifier hs-var">gsplitBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as
</span><a href="#local-6989586621679149455"><span class="hs-identifier hs-var">afs</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
</span><a href="#local-6989586621679149454"><span class="hs-identifier hs-var">zfs</span></a></span><span> </span><span class="annot"><span class="annottext">(BVar s (i ()) -&gt; o ())
-&gt; (BVar s (M1 p c i ()) -&gt; BVar s (i ()))
-&gt; BVar s (M1 p c i ())
-&gt; o ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">forall s.
Coercible (M1 p c i ()) (i ()) =&gt;
BVar s (M1 p c i ()) -&gt; BVar s (i ())
forall a b s. Coercible a b =&gt; BVar s a -&gt; BVar s b
</span><a href="Numeric.Backprop.Internal.html#coerceVar"><span class="hs-identifier hs-var">coerceVar</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149462"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-pragma hs-type">gsplitBV</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-399"></span><span>    </span><span id="local-6989586621679149452"><span class="annot"><span class="annottext">gjoinBV :: Rec AddFunc as
-&gt; Rec ZeroFunc as -&gt; M1 p c o () -&gt; BVar s (M1 p c i ())
</span><a href="#local-6989586621679149452"><span class="hs-identifier hs-var hs-var hs-var hs-var">gjoinBV</span></a></span></span><span> </span><span id="local-6989586621679149451"><span class="annot"><span class="annottext">afs :: Rec AddFunc as
</span><a href="#local-6989586621679149451"><span class="hs-identifier hs-var">afs</span></a></span></span><span> </span><span id="local-6989586621679149450"><span class="annot"><span class="annottext">zfs :: Rec ZeroFunc as
</span><a href="#local-6989586621679149450"><span class="hs-identifier hs-var">zfs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b s. Coercible (i ()) b =&gt; BVar s (i ()) -&gt; BVar s b
forall a b s. Coercible a b =&gt; BVar s a -&gt; BVar s b
</span><a href="Numeric.Backprop.Internal.html#coerceVar"><span class="hs-identifier hs-var">coerceVar</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149462"><span class="hs-identifier hs-type">i</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(BVar s (i ()) -&gt; BVar s (M1 p c i ()))
-&gt; (M1 p c o () -&gt; BVar s (i ()))
-&gt; M1 p c o ()
-&gt; BVar s (M1 p c i ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; o () -&gt; BVar s (i ())
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; o () -&gt; BVar s (i ())
</span><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-identifier hs-var">gjoinBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as
</span><a href="#local-6989586621679149451"><span class="hs-identifier hs-var">afs</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
</span><a href="#local-6989586621679149450"><span class="hs-identifier hs-var">zfs</span></a></span><span> </span><span class="annot"><span class="annottext">(o () -&gt; BVar s (i ()))
-&gt; (M1 p c o () -&gt; o ()) -&gt; M1 p c o () -&gt; BVar s (i ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">M1 p c o () -&gt; o ()
forall i (c :: Meta) k (f :: k -&gt; *) (p :: k). M1 i c f p -&gt; f p
</span><span class="hs-identifier hs-var hs-var">unM1</span></span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-pragma hs-type">gjoinBV</span></a></span><span> </span><span class="hs-pragma">#-}</span></span></span></span></span></span></span><span>
</span><span id="line-401"></span><span>
</span><span id="line-402"></span><span id="local-6989586621679149448"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149448"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">V1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">V1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-403"></span><span>    </span><span id="local-6989586621679149445"><span class="annot"><span class="annottext">gsplitBV :: Rec AddFunc '[] -&gt; Rec ZeroFunc '[] -&gt; BVar s (V1 ()) -&gt; V1 ()
</span><a href="#local-6989586621679149445"><span class="hs-identifier hs-var hs-var hs-var hs-var">gsplitBV</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BVar s (V1 ()) -&gt; V1 ()
forall a b. a -&gt; b
</span><span class="hs-identifier hs-var">unsafeCoerce</span></span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-pragma hs-type">gsplitBV</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-405"></span><span>    </span><span id="local-6989586621679149443"><span class="annot"><span class="annottext">gjoinBV :: Rec AddFunc '[] -&gt; Rec ZeroFunc '[] -&gt; V1 () -&gt; BVar s (V1 ())
</span><a href="#local-6989586621679149443"><span class="hs-identifier hs-var hs-var hs-var hs-var">gjoinBV</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-glyph">\</span></span><span class="hs-glyph">case</span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-pragma hs-type">gjoinBV</span></a></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-407"></span><span>
</span><span id="line-408"></span><span id="local-6989586621679149442"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149442"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">'</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-identifier hs-type">U1</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">U1</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-409"></span><span>    </span><span id="local-6989586621679149439"><span class="annot"><span class="annottext">gsplitBV :: Rec AddFunc '[] -&gt; Rec ZeroFunc '[] -&gt; BVar s (U1 ()) -&gt; U1 ()
</span><a href="#local-6989586621679149439"><span class="hs-identifier hs-var hs-var hs-var hs-var">gsplitBV</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">U1 ()
forall k (p :: k). U1 p
</span><span class="hs-identifier hs-var">U1</span></span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-pragma hs-type">gsplitBV</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-411"></span><span>    </span><span id="local-6989586621679149437"><span class="annot"><span class="annottext">gjoinBV :: Rec AddFunc '[] -&gt; Rec ZeroFunc '[] -&gt; U1 () -&gt; BVar s (U1 ())
</span><a href="#local-6989586621679149437"><span class="hs-identifier hs-var hs-var hs-var hs-var">gjoinBV</span></a></span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">U1 () -&gt; BVar s (U1 ())
forall a s. a -&gt; BVar s a
</span><a href="Numeric.Backprop.Internal.html#constVar"><span class="hs-identifier hs-var">constVar</span></a></span><span> </span><span class="annot"><span class="annottext">U1 ()
forall k (p :: k). U1 p
</span><span class="hs-identifier hs-var">U1</span></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-pragma hs-type">gjoinBV</span></a></span><span> </span><span class="hs-pragma">#-}</span></span><span>
</span><span id="line-413"></span><span>
</span><span id="line-414"></span><span id="local-6989586621679149429"><span id="local-6989586621679149430"><span id="local-6989586621679149431"><span id="local-6989586621679149432"><span id="local-6989586621679149433"><span id="local-6989586621679149434"><span id="local-6989586621679149435"><span id="local-6989586621679149436"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149436"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span>
</span><span id="line-415"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149436"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149435"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149434"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149433"><span class="hs-identifier hs-type">o1</span></a></span><span>
</span><span id="line-416"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149436"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149432"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149431"><span class="hs-identifier hs-type">i2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149430"><span class="hs-identifier hs-type">o2</span></a></span><span>
</span><span id="line-417"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149429"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149435"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621679149432"><span class="hs-identifier hs-type">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RecApplicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679149435"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-419"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149436"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149434"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679149431"><span class="hs-identifier hs-type">i2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679149429"><span class="hs-identifier hs-type">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149434"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679149431"><span class="hs-identifier hs-type">i2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149433"><span class="hs-identifier hs-type">o1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span class="annot"><a href="#local-6989586621679149430"><span class="hs-identifier hs-type">o2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-420"></span><span>    </span><span id="local-6989586621679149426"><span class="annot"><span class="annottext">gsplitBV :: Rec AddFunc (i1 () : i2 () : cs)
-&gt; Rec ZeroFunc (i1 () : i2 () : cs)
-&gt; BVar s ((:*:) i1 i2 ())
-&gt; (:*:) o1 o2 ()
</span><a href="#local-6989586621679149426"><span class="hs-identifier hs-var hs-var hs-var hs-var">gsplitBV</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149425"><span class="annot"><span class="annottext">afa :: AddFunc r
</span><a href="#local-6989586621679149425"><span class="hs-identifier hs-var">afa</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149424"><span class="annot"><span class="annottext">afb :: AddFunc r
</span><a href="#local-6989586621679149424"><span class="hs-identifier hs-var">afb</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149423"><span class="annot"><span class="annottext">afs :: Rec AddFunc rs
</span><a href="#local-6989586621679149423"><span class="hs-identifier hs-var">afs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149422"><span class="annot"><span class="annottext">zfa :: ZeroFunc r
</span><a href="#local-6989586621679149422"><span class="hs-identifier hs-var">zfa</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149421"><span class="annot"><span class="annottext">zfb :: ZeroFunc r
</span><a href="#local-6989586621679149421"><span class="hs-identifier hs-var">zfb</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149420"><span class="annot"><span class="annottext">zfs :: Rec ZeroFunc rs
</span><a href="#local-6989586621679149420"><span class="hs-identifier hs-var">zfs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679149419"><span class="annot"><span class="annottext">xy :: BVar s ((:*:) i1 i2 ())
</span><a href="#local-6989586621679149419"><span class="hs-identifier hs-var">xy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">o1 ()
</span><a href="#local-6989586621679149418"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">o1 () -&gt; o2 () -&gt; (:*:) o1 o2 ()
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="annot"><span class="annottext">o2 ()
</span><a href="#local-6989586621679149416"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-421"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-422"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679149415"><span class="annot"><span class="annottext">afas :: Rec AddFunc as
</span><a href="#local-6989586621679149415"><span class="hs-identifier hs-var">afas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149414"><span class="annot"><span class="annottext">afbs :: Rec AddFunc bs
</span><a href="#local-6989586621679149414"><span class="hs-identifier hs-var">afbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec AddFunc (as ++ bs) -&gt; (Rec AddFunc as, Rec AddFunc bs)
forall u (f :: u -&gt; *) (as :: [u]) (bs :: [u]).
RecApplicative as =&gt;
Rec f (as ++ bs) -&gt; (Rec f as, Rec f bs)
</span><a href="Data.Type.Util.html#splitRec"><span class="hs-identifier hs-var">splitRec</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc rs
Rec AddFunc (as ++ bs)
</span><a href="#local-6989586621679149423"><span class="hs-identifier hs-var">afs</span></a></span><span>
</span><span id="line-423"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679149412"><span class="annot"><span class="annottext">zfas :: Rec ZeroFunc as
</span><a href="#local-6989586621679149412"><span class="hs-identifier hs-var">zfas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149411"><span class="annot"><span class="annottext">zfbs :: Rec ZeroFunc bs
</span><a href="#local-6989586621679149411"><span class="hs-identifier hs-var">zfbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc (as ++ bs) -&gt; (Rec ZeroFunc as, Rec ZeroFunc bs)
forall u (f :: u -&gt; *) (as :: [u]) (bs :: [u]).
RecApplicative as =&gt;
Rec f (as ++ bs) -&gt; (Rec f as, Rec f bs)
</span><a href="Data.Type.Util.html#splitRec"><span class="hs-identifier hs-var">splitRec</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc rs
Rec ZeroFunc (as ++ bs)
</span><a href="#local-6989586621679149420"><span class="hs-identifier hs-var">zfs</span></a></span><span>
</span><span id="line-424"></span><span>        </span><span id="local-6989586621679149410"><span class="annot"><span class="annottext">zfab :: ZeroFunc ((:*:) i1 i2 ())
</span><a href="#local-6989586621679149410"><span class="hs-identifier hs-var hs-var">zfab</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((:*:) i1 i2 () -&gt; (:*:) i1 i2 ()) -&gt; ZeroFunc ((:*:) i1 i2 ())
forall a. (a -&gt; a) -&gt; ZeroFunc a
</span><a href="Numeric.Backprop.Internal.html#ZF"><span class="hs-identifier hs-var">ZF</span></a></span><span> </span><span class="annot"><span class="annottext">(((:*:) i1 i2 () -&gt; (:*:) i1 i2 ()) -&gt; ZeroFunc ((:*:) i1 i2 ()))
-&gt; ((:*:) i1 i2 () -&gt; (:*:) i1 i2 ()) -&gt; ZeroFunc ((:*:) i1 i2 ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679149409"><span class="annot"><span class="annottext">xx :: i1 ()
</span><a href="#local-6989586621679149409"><span class="hs-identifier hs-var">xx</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679149408"><span class="annot"><span class="annottext">yy :: i2 ()
</span><a href="#local-6989586621679149408"><span class="hs-identifier hs-var">yy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ZeroFunc r -&gt; r -&gt; r
forall a. ZeroFunc a -&gt; a -&gt; a
</span><a href="Numeric.Backprop.Internal.html#runZF"><span class="hs-identifier hs-var hs-var">runZF</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc r
</span><a href="#local-6989586621679149422"><span class="hs-identifier hs-var">zfa</span></a></span><span> </span><span class="annot"><span class="annottext">r
i1 ()
</span><a href="#local-6989586621679149409"><span class="hs-identifier hs-var">xx</span></a></span><span> </span><span class="annot"><span class="annottext">i1 () -&gt; i2 () -&gt; (:*:) i1 i2 ()
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">:*:</span></span><span> </span><span class="annot"><span class="annottext">ZeroFunc r -&gt; r -&gt; r
forall a. ZeroFunc a -&gt; a -&gt; a
</span><a href="Numeric.Backprop.Internal.html#runZF"><span class="hs-identifier hs-var hs-var">runZF</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc r
</span><a href="#local-6989586621679149421"><span class="hs-identifier hs-var">zfb</span></a></span><span> </span><span class="annot"><span class="annottext">r
i2 ()
</span><a href="#local-6989586621679149408"><span class="hs-identifier hs-var">yy</span></a></span><span>
</span><span id="line-425"></span><span>        </span><span id="local-6989586621679149418"><span class="annot"><span class="annottext">x :: o1 ()
</span><a href="#local-6989586621679149418"><span class="hs-identifier hs-var hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; BVar s (i1 ()) -&gt; o1 ()
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; BVar s (i ()) -&gt; o ()
</span><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-identifier hs-var">gsplitBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as
</span><a href="#local-6989586621679149415"><span class="hs-identifier hs-var">afas</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
</span><a href="#local-6989586621679149412"><span class="hs-identifier hs-var">zfas</span></a></span><span> </span><span class="annot"><span class="annottext">(BVar s (i1 ()) -&gt; o1 ())
-&gt; (BVar s ((:*:) i1 i2 ()) -&gt; BVar s (i1 ()))
-&gt; BVar s ((:*:) i1 i2 ())
-&gt; o1 ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AddFunc r
-&gt; ZeroFunc ((:*:) i1 i2 ())
-&gt; Lens' ((:*:) i1 i2 ()) r
-&gt; BVar s ((:*:) i1 i2 ())
-&gt; BVar s r
forall a b s.
Reifies s W =&gt;
AddFunc a -&gt; ZeroFunc b -&gt; Lens' b a -&gt; BVar s b -&gt; BVar s a
</span><a href="Numeric.Backprop.Internal.html#viewVar"><span class="hs-identifier hs-var">viewVar</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc r
</span><a href="#local-6989586621679149425"><span class="hs-identifier hs-var">afa</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc ((:*:) i1 i2 ())
</span><a href="#local-6989586621679149410"><span class="hs-identifier hs-var">zfab</span></a></span><span> </span><span class="annot"><span class="annottext">forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
Lens' ((:*:) f g a) (f a)
Lens' ((:*:) i1 i2 ()) r
</span><a href="Data.Type.Util.html#p1"><span class="hs-identifier hs-var">p1</span></a></span><span> </span><span class="annot"><span class="annottext">(BVar s ((:*:) i1 i2 ()) -&gt; o1 ())
-&gt; BVar s ((:*:) i1 i2 ()) -&gt; o1 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BVar s ((:*:) i1 i2 ())
</span><a href="#local-6989586621679149419"><span class="hs-identifier hs-var">xy</span></a></span><span>
</span><span id="line-426"></span><span>        </span><span id="local-6989586621679149416"><span class="annot"><span class="annottext">y :: o2 ()
</span><a href="#local-6989586621679149416"><span class="hs-identifier hs-var hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec AddFunc bs -&gt; Rec ZeroFunc bs -&gt; BVar s (i2 ()) -&gt; o2 ()
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; BVar s (i ()) -&gt; o ()
</span><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-identifier hs-var">gsplitBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc bs
</span><a href="#local-6989586621679149414"><span class="hs-identifier hs-var">afbs</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc bs
</span><a href="#local-6989586621679149411"><span class="hs-identifier hs-var">zfbs</span></a></span><span> </span><span class="annot"><span class="annottext">(BVar s (i2 ()) -&gt; o2 ())
-&gt; (BVar s ((:*:) i1 i2 ()) -&gt; BVar s (i2 ()))
-&gt; BVar s ((:*:) i1 i2 ())
-&gt; o2 ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AddFunc r
-&gt; ZeroFunc ((:*:) i1 i2 ())
-&gt; Lens' ((:*:) i1 i2 ()) r
-&gt; BVar s ((:*:) i1 i2 ())
-&gt; BVar s r
forall a b s.
Reifies s W =&gt;
AddFunc a -&gt; ZeroFunc b -&gt; Lens' b a -&gt; BVar s b -&gt; BVar s a
</span><a href="Numeric.Backprop.Internal.html#viewVar"><span class="hs-identifier hs-var">viewVar</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc r
</span><a href="#local-6989586621679149424"><span class="hs-identifier hs-var">afb</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc ((:*:) i1 i2 ())
</span><a href="#local-6989586621679149410"><span class="hs-identifier hs-var">zfab</span></a></span><span> </span><span class="annot"><span class="annottext">forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
Lens' ((:*:) f g a) (g a)
Lens' ((:*:) i1 i2 ()) r
</span><a href="Data.Type.Util.html#p2"><span class="hs-identifier hs-var">p2</span></a></span><span> </span><span class="annot"><span class="annottext">(BVar s ((:*:) i1 i2 ()) -&gt; o2 ())
-&gt; BVar s ((:*:) i1 i2 ()) -&gt; o2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">BVar s ((:*:) i1 i2 ())
</span><a href="#local-6989586621679149419"><span class="hs-identifier hs-var">xy</span></a></span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-pragma hs-type">gsplitBV</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-428"></span><span>    </span><span id="local-6989586621679149404"><span class="annot"><span class="annottext">gjoinBV :: Rec AddFunc (i1 () : i2 () : cs)
-&gt; Rec ZeroFunc (i1 () : i2 () : cs)
-&gt; (:*:) o1 o2 ()
-&gt; BVar s ((:*:) i1 i2 ())
</span><a href="#local-6989586621679149404"><span class="hs-identifier hs-var hs-var hs-var hs-var">gjoinBV</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149403"><span class="annot"><span class="annottext">afa :: AddFunc r
</span><a href="#local-6989586621679149403"><span class="hs-identifier hs-var">afa</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149402"><span class="annot"><span class="annottext">afb :: AddFunc r
</span><a href="#local-6989586621679149402"><span class="hs-identifier hs-var">afb</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149401"><span class="annot"><span class="annottext">afs :: Rec AddFunc rs
</span><a href="#local-6989586621679149401"><span class="hs-identifier hs-var">afs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149400"><span class="annot"><span class="annottext">zfs :: Rec ZeroFunc rs
</span><a href="#local-6989586621679149400"><span class="hs-identifier hs-var">zfs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149399"><span class="annot"><span class="annottext">x :: o1 ()
</span><a href="#local-6989586621679149399"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679149398"><span class="annot"><span class="annottext">y :: o2 ()
</span><a href="#local-6989586621679149398"><span class="hs-identifier hs-var">y</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-429"></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">AddFunc r
-&gt; AddFunc r
-&gt; (r -&gt; r -&gt; (:*:) i1 i2 ())
-&gt; ((:*:) i1 i2 () -&gt; (r, r))
-&gt; BVar s r
-&gt; BVar s r
-&gt; BVar s ((:*:) i1 i2 ())
forall s a b c.
Reifies s W =&gt;
AddFunc a
-&gt; AddFunc b
-&gt; (a -&gt; b -&gt; c)
-&gt; (c -&gt; (a, b))
-&gt; BVar s a
-&gt; BVar s b
-&gt; BVar s c
</span><a href="Numeric.Backprop.Explicit.html#isoVar2"><span class="hs-identifier hs-var">isoVar2</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc r
</span><a href="#local-6989586621679149403"><span class="hs-identifier hs-var">afa</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc r
</span><a href="#local-6989586621679149402"><span class="hs-identifier hs-var">afb</span></a></span><span> </span><span class="annot"><span class="annottext">r -&gt; r -&gt; (:*:) i1 i2 ()
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k).
f p -&gt; g p -&gt; (:*:) f g p
</span><span class="hs-operator hs-var">(:*:)</span></span><span> </span><span class="annot"><span class="annottext">(:*:) i1 i2 () -&gt; (r, r)
forall (f :: * -&gt; *) (g :: * -&gt; *) p. (:*:) f g p -&gt; (f p, g p)
</span><a href="#local-6989586621679149397"><span class="hs-identifier hs-var">unP</span></a></span><span>
</span><span id="line-430"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; o1 () -&gt; BVar s (i1 ())
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; o () -&gt; BVar s (i ())
</span><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-identifier hs-var">gjoinBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as
</span><a href="#local-6989586621679149396"><span class="hs-identifier hs-var">afas</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
</span><a href="#local-6989586621679149395"><span class="hs-identifier hs-var">zfas</span></a></span><span> </span><span class="annot"><span class="annottext">o1 ()
</span><a href="#local-6989586621679149399"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-431"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec AddFunc bs -&gt; Rec ZeroFunc bs -&gt; o2 () -&gt; BVar s (i2 ())
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; o () -&gt; BVar s (i ())
</span><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-identifier hs-var">gjoinBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc bs
</span><a href="#local-6989586621679149394"><span class="hs-identifier hs-var">afbs</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc bs
</span><a href="#local-6989586621679149393"><span class="hs-identifier hs-var">zfbs</span></a></span><span> </span><span class="annot"><span class="annottext">o2 ()
</span><a href="#local-6989586621679149398"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-432"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-433"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679149396"><span class="annot"><span class="annottext">afas :: Rec AddFunc as
</span><a href="#local-6989586621679149396"><span class="hs-identifier hs-var">afas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149394"><span class="annot"><span class="annottext">afbs :: Rec AddFunc bs
</span><a href="#local-6989586621679149394"><span class="hs-identifier hs-var">afbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec AddFunc (as ++ bs) -&gt; (Rec AddFunc as, Rec AddFunc bs)
forall u (f :: u -&gt; *) (as :: [u]) (bs :: [u]).
RecApplicative as =&gt;
Rec f (as ++ bs) -&gt; (Rec f as, Rec f bs)
</span><a href="Data.Type.Util.html#splitRec"><span class="hs-identifier hs-var">splitRec</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc rs
Rec AddFunc (as ++ bs)
</span><a href="#local-6989586621679149401"><span class="hs-identifier hs-var">afs</span></a></span><span>
</span><span id="line-434"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679149395"><span class="annot"><span class="annottext">zfas :: Rec ZeroFunc as
</span><a href="#local-6989586621679149395"><span class="hs-identifier hs-var">zfas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149393"><span class="annot"><span class="annottext">zfbs :: Rec ZeroFunc bs
</span><a href="#local-6989586621679149393"><span class="hs-identifier hs-var">zfbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc (as ++ bs) -&gt; (Rec ZeroFunc as, Rec ZeroFunc bs)
forall u (f :: u -&gt; *) (as :: [u]) (bs :: [u]).
RecApplicative as =&gt;
Rec f (as ++ bs) -&gt; (Rec f as, Rec f bs)
</span><a href="Data.Type.Util.html#splitRec"><span class="hs-identifier hs-var">splitRec</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc rs
Rec ZeroFunc (as ++ bs)
</span><a href="#local-6989586621679149400"><span class="hs-identifier hs-var">zfs</span></a></span><span>
</span><span id="line-435"></span><span>        </span><span id="local-6989586621679149397"><span class="annot"><span class="annottext">unP :: (:*:) f g p -&gt; (f p, g p)
</span><a href="#local-6989586621679149397"><span class="hs-identifier hs-var hs-var">unP</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149392"><span class="annot"><span class="annottext">xx :: f p
</span><a href="#local-6989586621679149392"><span class="hs-identifier hs-var">xx</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:*:</span></span><span> </span><span id="local-6989586621679149391"><span class="annot"><span class="annottext">yy :: g p
</span><a href="#local-6989586621679149391"><span class="hs-identifier hs-var">yy</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">f p
</span><a href="#local-6989586621679149392"><span class="hs-identifier hs-var">xx</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">g p
</span><a href="#local-6989586621679149391"><span class="hs-identifier hs-var">yy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-436"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-pragma hs-type">gjoinBV</span></a></span><span> </span><span class="hs-pragma">#-}</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-437"></span><span>
</span><span id="line-438"></span><span class="hs-comment">-- | This instance is possible but it is not clear when it would be useful</span><span>
</span><span id="line-439"></span><span id="local-6989586621679149383"><span id="local-6989586621679149384"><span id="local-6989586621679149385"><span id="local-6989586621679149386"><span id="local-6989586621679149387"><span id="local-6989586621679149388"><span id="local-6989586621679149389"><span id="local-6989586621679149390"><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149390"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span>
</span><span id="line-440"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149390"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149389"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149388"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149387"><span class="hs-identifier hs-type">o1</span></a></span><span>
</span><span id="line-441"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149390"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149386"><span class="hs-identifier hs-type">bs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149385"><span class="hs-identifier hs-type">i2</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149384"><span class="hs-identifier hs-type">o2</span></a></span><span>
</span><span id="line-442"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679149383"><span class="hs-identifier hs-type">cs</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149389"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">++</span></span><span> </span><span class="annot"><a href="#local-6989586621679149386"><span class="hs-identifier hs-type">bs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>         </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">RecApplicative</span></span><span> </span><span class="annot"><a href="#local-6989586621679149389"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-444"></span><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149390"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149388"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679149385"><span class="hs-identifier hs-type">i2</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">'</span><span class="hs-glyph">:</span><span> </span><span class="annot"><a href="#local-6989586621679149383"><span class="hs-identifier hs-type">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149388"><span class="hs-identifier hs-type">i1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+:</span></span><span> </span><span class="annot"><a href="#local-6989586621679149385"><span class="hs-identifier hs-type">i2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149387"><span class="hs-identifier hs-type">o1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:+:</span></span><span> </span><span class="annot"><a href="#local-6989586621679149384"><span class="hs-identifier hs-type">o2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-445"></span><span>    </span><span id="local-6989586621679149380"><span class="annot"><span class="annottext">gsplitBV :: Rec AddFunc (i1 () : i2 () : cs)
-&gt; Rec ZeroFunc (i1 () : i2 () : cs)
-&gt; BVar s ((:+:) i1 i2 ())
-&gt; (:+:) o1 o2 ()
</span><a href="#local-6989586621679149380"><span class="hs-identifier hs-var hs-var hs-var hs-var">gsplitBV</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149379"><span class="annot"><span class="annottext">afa :: AddFunc r
</span><a href="#local-6989586621679149379"><span class="hs-identifier hs-var">afa</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149378"><span class="annot"><span class="annottext">afb :: AddFunc r
</span><a href="#local-6989586621679149378"><span class="hs-identifier hs-var">afb</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149377"><span class="annot"><span class="annottext">afs :: Rec AddFunc rs
</span><a href="#local-6989586621679149377"><span class="hs-identifier hs-var">afs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149376"><span class="annot"><span class="annottext">zfa :: ZeroFunc r
</span><a href="#local-6989586621679149376"><span class="hs-identifier hs-var">zfa</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149375"><span class="annot"><span class="annottext">zfb :: ZeroFunc r
</span><a href="#local-6989586621679149375"><span class="hs-identifier hs-var">zfb</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149374"><span class="annot"><span class="annottext">zfs :: Rec ZeroFunc rs
</span><a href="#local-6989586621679149374"><span class="hs-identifier hs-var">zfs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679149373"><span class="annot"><span class="annottext">xy :: BVar s ((:+:) i1 i2 ())
</span><a href="#local-6989586621679149373"><span class="hs-identifier hs-var">xy</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-446"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AddFunc r
-&gt; ZeroFunc ((:+:) i1 i2 ())
-&gt; Traversal' ((:+:) i1 i2 ()) r
-&gt; BVar s ((:+:) i1 i2 ())
-&gt; Maybe (BVar s r)
forall b a s.
Reifies s W =&gt;
AddFunc a
-&gt; ZeroFunc b -&gt; Traversal' b a -&gt; BVar s b -&gt; Maybe (BVar s a)
</span><a href="Numeric.Backprop.Internal.html#previewVar"><span class="hs-identifier hs-var">previewVar</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc r
</span><a href="#local-6989586621679149379"><span class="hs-identifier hs-var">afa</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc ((:+:) i1 i2 ())
</span><a href="#local-6989586621679149372"><span class="hs-identifier hs-var">zf</span></a></span><span> </span><span class="annot"><span class="annottext">forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
Traversal' ((:+:) f g a) (f a)
Traversal' ((:+:) i1 i2 ()) r
</span><a href="Data.Type.Util.html#s1"><span class="hs-identifier hs-var">s1</span></a></span><span> </span><span class="annot"><span class="annottext">BVar s ((:+:) i1 i2 ())
</span><a href="#local-6989586621679149373"><span class="hs-identifier hs-var">xy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-447"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679149370"><span class="annot"><span class="annottext">x :: BVar s r
</span><a href="#local-6989586621679149370"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">o1 () -&gt; (:+:) o1 o2 ()
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). f p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">L1</span></span><span> </span><span class="annot"><span class="annottext">(o1 () -&gt; (:+:) o1 o2 ()) -&gt; o1 () -&gt; (:+:) o1 o2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; BVar s (i1 ()) -&gt; o1 ()
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; BVar s (i ()) -&gt; o ()
</span><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-identifier hs-var">gsplitBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as
</span><a href="#local-6989586621679149368"><span class="hs-identifier hs-var">afas</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
</span><a href="#local-6989586621679149367"><span class="hs-identifier hs-var">zfas</span></a></span><span> </span><span class="annot"><span class="annottext">BVar s r
BVar s (i1 ())
</span><a href="#local-6989586621679149370"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-448"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">AddFunc r
-&gt; ZeroFunc ((:+:) i1 i2 ())
-&gt; Traversal' ((:+:) i1 i2 ()) r
-&gt; BVar s ((:+:) i1 i2 ())
-&gt; Maybe (BVar s r)
forall b a s.
Reifies s W =&gt;
AddFunc a
-&gt; ZeroFunc b -&gt; Traversal' b a -&gt; BVar s b -&gt; Maybe (BVar s a)
</span><a href="Numeric.Backprop.Internal.html#previewVar"><span class="hs-identifier hs-var">previewVar</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc r
</span><a href="#local-6989586621679149378"><span class="hs-identifier hs-var">afb</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc ((:+:) i1 i2 ())
</span><a href="#local-6989586621679149372"><span class="hs-identifier hs-var">zf</span></a></span><span> </span><span class="annot"><span class="annottext">forall k (f :: k -&gt; *) (g :: k -&gt; *) (a :: k).
Traversal' ((:+:) f g a) (g a)
Traversal' ((:+:) i1 i2 ()) r
</span><a href="Data.Type.Util.html#s2"><span class="hs-identifier hs-var">s2</span></a></span><span> </span><span class="annot"><span class="annottext">BVar s ((:+:) i1 i2 ())
</span><a href="#local-6989586621679149373"><span class="hs-identifier hs-var">xy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-449"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679149365"><span class="annot"><span class="annottext">y :: BVar s r
</span><a href="#local-6989586621679149365"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">o2 () -&gt; (:+:) o1 o2 ()
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). g p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">R1</span></span><span> </span><span class="annot"><span class="annottext">(o2 () -&gt; (:+:) o1 o2 ()) -&gt; o2 () -&gt; (:+:) o1 o2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc bs -&gt; Rec ZeroFunc bs -&gt; BVar s (i2 ()) -&gt; o2 ()
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; BVar s (i ()) -&gt; o ()
</span><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-identifier hs-var">gsplitBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc bs
</span><a href="#local-6989586621679149363"><span class="hs-identifier hs-var">afbs</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc bs
</span><a href="#local-6989586621679149362"><span class="hs-identifier hs-var">zfbs</span></a></span><span> </span><span class="annot"><span class="annottext">BVar s r
BVar s (i2 ())
</span><a href="#local-6989586621679149365"><span class="hs-identifier hs-var">y</span></a></span><span>
</span><span id="line-450"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; (:+:) o1 o2 ()
forall a. HasCallStack =&gt; [Char] -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="hs-string">&quot;Numeric.Backprop.gsplitBV: Internal error occurred&quot;</span></span><span>
</span><span id="line-451"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-452"></span><span>        </span><span id="local-6989586621679149372"><span class="annot"><span class="annottext">zf :: ZeroFunc ((:+:) i1 i2 ())
</span><a href="#local-6989586621679149372"><span class="hs-identifier hs-var hs-var">zf</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((:+:) i1 i2 () -&gt; (:+:) i1 i2 ()) -&gt; ZeroFunc ((:+:) i1 i2 ())
forall a. (a -&gt; a) -&gt; ZeroFunc a
</span><a href="Numeric.Backprop.Internal.html#ZF"><span class="hs-identifier hs-var">ZF</span></a></span><span> </span><span class="annot"><span class="annottext">(((:+:) i1 i2 () -&gt; (:+:) i1 i2 ()) -&gt; ZeroFunc ((:+:) i1 i2 ()))
-&gt; ((:+:) i1 i2 () -&gt; (:+:) i1 i2 ()) -&gt; ZeroFunc ((:+:) i1 i2 ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-453"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span id="local-6989586621679149360"><span class="annot"><span class="annottext">xx :: i1 ()
</span><a href="#local-6989586621679149360"><span class="hs-identifier hs-var">xx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">i1 () -&gt; (:+:) i1 i2 ()
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). f p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">L1</span></span><span> </span><span class="annot"><span class="annottext">(i1 () -&gt; (:+:) i1 i2 ()) -&gt; i1 () -&gt; (:+:) i1 i2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ZeroFunc r -&gt; r -&gt; r
forall a. ZeroFunc a -&gt; a -&gt; a
</span><a href="Numeric.Backprop.Internal.html#runZF"><span class="hs-identifier hs-var hs-var">runZF</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc r
</span><a href="#local-6989586621679149376"><span class="hs-identifier hs-var">zfa</span></a></span><span> </span><span class="annot"><span class="annottext">r
i1 ()
</span><a href="#local-6989586621679149360"><span class="hs-identifier hs-var">xx</span></a></span><span>
</span><span id="line-454"></span><span>            </span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span id="local-6989586621679149359"><span class="annot"><span class="annottext">yy :: i2 ()
</span><a href="#local-6989586621679149359"><span class="hs-identifier hs-var">yy</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">i2 () -&gt; (:+:) i1 i2 ()
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). g p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">R1</span></span><span> </span><span class="annot"><span class="annottext">(i2 () -&gt; (:+:) i1 i2 ()) -&gt; i2 () -&gt; (:+:) i1 i2 ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">ZeroFunc r -&gt; r -&gt; r
forall a. ZeroFunc a -&gt; a -&gt; a
</span><a href="Numeric.Backprop.Internal.html#runZF"><span class="hs-identifier hs-var hs-var">runZF</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc r
</span><a href="#local-6989586621679149375"><span class="hs-identifier hs-var">zfb</span></a></span><span> </span><span class="annot"><span class="annottext">r
i2 ()
</span><a href="#local-6989586621679149359"><span class="hs-identifier hs-var">yy</span></a></span><span>
</span><span id="line-455"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679149368"><span class="annot"><span class="annottext">afas :: Rec AddFunc as
</span><a href="#local-6989586621679149368"><span class="hs-identifier hs-var">afas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149363"><span class="annot"><span class="annottext">afbs :: Rec AddFunc bs
</span><a href="#local-6989586621679149363"><span class="hs-identifier hs-var">afbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec AddFunc (as ++ bs) -&gt; (Rec AddFunc as, Rec AddFunc bs)
forall u (f :: u -&gt; *) (as :: [u]) (bs :: [u]).
RecApplicative as =&gt;
Rec f (as ++ bs) -&gt; (Rec f as, Rec f bs)
</span><a href="Data.Type.Util.html#splitRec"><span class="hs-identifier hs-var">splitRec</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc rs
Rec AddFunc (as ++ bs)
</span><a href="#local-6989586621679149377"><span class="hs-identifier hs-var">afs</span></a></span><span>
</span><span id="line-456"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679149367"><span class="annot"><span class="annottext">zfas :: Rec ZeroFunc as
</span><a href="#local-6989586621679149367"><span class="hs-identifier hs-var">zfas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149362"><span class="annot"><span class="annottext">zfbs :: Rec ZeroFunc bs
</span><a href="#local-6989586621679149362"><span class="hs-identifier hs-var">zfbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc (as ++ bs) -&gt; (Rec ZeroFunc as, Rec ZeroFunc bs)
forall u (f :: u -&gt; *) (as :: [u]) (bs :: [u]).
RecApplicative as =&gt;
Rec f (as ++ bs) -&gt; (Rec f as, Rec f bs)
</span><a href="Data.Type.Util.html#splitRec"><span class="hs-identifier hs-var">splitRec</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc rs
Rec ZeroFunc (as ++ bs)
</span><a href="#local-6989586621679149374"><span class="hs-identifier hs-var">zfs</span></a></span><span>
</span><span id="line-457"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-pragma hs-type">gsplitBV</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-458"></span><span>    </span><span id="local-6989586621679149358"><span class="annot"><span class="annottext">gjoinBV :: Rec AddFunc (i1 () : i2 () : cs)
-&gt; Rec ZeroFunc (i1 () : i2 () : cs)
-&gt; (:+:) o1 o2 ()
-&gt; BVar s ((:+:) i1 i2 ())
</span><a href="#local-6989586621679149358"><span class="hs-identifier hs-var hs-var hs-var hs-var">gjoinBV</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149357"><span class="annot"><span class="annottext">afa :: AddFunc r
</span><a href="#local-6989586621679149357"><span class="hs-identifier hs-var">afa</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149356"><span class="annot"><span class="annottext">afb :: AddFunc r
</span><a href="#local-6989586621679149356"><span class="hs-identifier hs-var">afb</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149355"><span class="annot"><span class="annottext">afs :: Rec AddFunc rs
</span><a href="#local-6989586621679149355"><span class="hs-identifier hs-var">afs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679149354"><span class="annot"><span class="annottext">zfa :: ZeroFunc r
</span><a href="#local-6989586621679149354"><span class="hs-identifier hs-var">zfa</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149353"><span class="annot"><span class="annottext">zfb :: ZeroFunc r
</span><a href="#local-6989586621679149353"><span class="hs-identifier hs-var">zfb</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:&amp;</span></span><span> </span><span id="local-6989586621679149352"><span class="annot"><span class="annottext">zfs :: Rec ZeroFunc rs
</span><a href="#local-6989586621679149352"><span class="hs-identifier hs-var">zfs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-459"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span id="local-6989586621679149351"><span class="annot"><span class="annottext">x :: o1 ()
</span><a href="#local-6989586621679149351"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddFunc r
-&gt; Op '[r] ((:+:) i1 i2 ()) -&gt; BVar s r -&gt; BVar s ((:+:) i1 i2 ())
forall a b s.
Reifies s W =&gt;
AddFunc a -&gt; Op '[a] b -&gt; BVar s a -&gt; BVar s b
</span><a href="Numeric.Backprop.Internal.html#liftOp1"><span class="hs-identifier hs-var">liftOp1</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc r
</span><a href="#local-6989586621679149357"><span class="hs-identifier hs-var">afa</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i1 () -&gt; ((:+:) i1 i2 (), (:+:) i1 i2 () -&gt; i1 ()))
-&gt; Op '[i1 ()] ((:+:) i1 i2 ())
forall a b. (a -&gt; (b, b -&gt; a)) -&gt; Op '[a] b
</span><a href="Numeric.Backprop.Op.html#op1"><span class="hs-identifier hs-var">op1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679149350"><span class="annot"><span class="annottext">xx :: i1 ()
</span><a href="#local-6989586621679149350"><span class="hs-identifier hs-var">xx</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i1 () -&gt; (:+:) i1 i2 ()
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). f p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">L1</span></span><span> </span><span class="annot"><span class="annottext">i1 ()
</span><a href="#local-6989586621679149350"><span class="hs-identifier hs-var">xx</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span id="local-6989586621679149349"><span class="annot"><span class="annottext">d :: i1 ()
</span><a href="#local-6989586621679149349"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">i1 ()
</span><a href="#local-6989586621679149349"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ZeroFunc r -&gt; r -&gt; r
forall a. ZeroFunc a -&gt; a -&gt; a
</span><a href="Numeric.Backprop.Internal.html#runZF"><span class="hs-identifier hs-var hs-var">runZF</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc r
</span><a href="#local-6989586621679149354"><span class="hs-identifier hs-var">zfa</span></a></span><span> </span><span class="annot"><span class="annottext">r
i1 ()
</span><a href="#local-6989586621679149350"><span class="hs-identifier hs-var">xx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-460"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; o1 () -&gt; BVar s (i1 ())
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; o () -&gt; BVar s (i ())
</span><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-identifier hs-var">gjoinBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as
</span><a href="#local-6989586621679149348"><span class="hs-identifier hs-var">afas</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
</span><a href="#local-6989586621679149347"><span class="hs-identifier hs-var">zfas</span></a></span><span> </span><span class="annot"><span class="annottext">o1 ()
</span><a href="#local-6989586621679149351"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-461"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span id="local-6989586621679149346"><span class="annot"><span class="annottext">y :: o2 ()
</span><a href="#local-6989586621679149346"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AddFunc r
-&gt; Op '[r] ((:+:) i1 i2 ()) -&gt; BVar s r -&gt; BVar s ((:+:) i1 i2 ())
forall a b s.
Reifies s W =&gt;
AddFunc a -&gt; Op '[a] b -&gt; BVar s a -&gt; BVar s b
</span><a href="Numeric.Backprop.Internal.html#liftOp1"><span class="hs-identifier hs-var">liftOp1</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc r
</span><a href="#local-6989586621679149356"><span class="hs-identifier hs-var">afb</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(i2 () -&gt; ((:+:) i1 i2 (), (:+:) i1 i2 () -&gt; i2 ()))
-&gt; Op '[i2 ()] ((:+:) i1 i2 ())
forall a b. (a -&gt; (b, b -&gt; a)) -&gt; Op '[a] b
</span><a href="Numeric.Backprop.Op.html#op1"><span class="hs-identifier hs-var">op1</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679149345"><span class="annot"><span class="annottext">yy :: i2 ()
</span><a href="#local-6989586621679149345"><span class="hs-identifier hs-var">yy</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">i2 () -&gt; (:+:) i1 i2 ()
forall k (f :: k -&gt; *) (g :: k -&gt; *) (p :: k). g p -&gt; (:+:) f g p
</span><span class="hs-identifier hs-var">R1</span></span><span> </span><span class="annot"><span class="annottext">i2 ()
</span><a href="#local-6989586621679149345"><span class="hs-identifier hs-var">yy</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L1</span></span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ZeroFunc r -&gt; r -&gt; r
forall a. ZeroFunc a -&gt; a -&gt; a
</span><a href="Numeric.Backprop.Internal.html#runZF"><span class="hs-identifier hs-var hs-var">runZF</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc r
</span><a href="#local-6989586621679149353"><span class="hs-identifier hs-var">zfb</span></a></span><span> </span><span class="annot"><span class="annottext">r
i2 ()
</span><a href="#local-6989586621679149345"><span class="hs-identifier hs-var">yy</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">R1</span></span><span> </span><span id="local-6989586621679149344"><span class="annot"><span class="annottext">d :: i2 ()
</span><a href="#local-6989586621679149344"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">i2 ()
</span><a href="#local-6989586621679149344"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-462"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Rec AddFunc bs -&gt; Rec ZeroFunc bs -&gt; o2 () -&gt; BVar s (i2 ())
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; o () -&gt; BVar s (i ())
</span><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-identifier hs-var">gjoinBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc bs
</span><a href="#local-6989586621679149343"><span class="hs-identifier hs-var">afbs</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc bs
</span><a href="#local-6989586621679149342"><span class="hs-identifier hs-var">zfbs</span></a></span><span> </span><span class="annot"><span class="annottext">o2 ()
</span><a href="#local-6989586621679149346"><span class="hs-identifier hs-var">y</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-463"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-464"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679149348"><span class="annot"><span class="annottext">afas :: Rec AddFunc as
</span><a href="#local-6989586621679149348"><span class="hs-identifier hs-var">afas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149343"><span class="annot"><span class="annottext">afbs :: Rec AddFunc bs
</span><a href="#local-6989586621679149343"><span class="hs-identifier hs-var">afbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec AddFunc (as ++ bs) -&gt; (Rec AddFunc as, Rec AddFunc bs)
forall u (f :: u -&gt; *) (as :: [u]) (bs :: [u]).
RecApplicative as =&gt;
Rec f (as ++ bs) -&gt; (Rec f as, Rec f bs)
</span><a href="Data.Type.Util.html#splitRec"><span class="hs-identifier hs-var">splitRec</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc rs
Rec AddFunc (as ++ bs)
</span><a href="#local-6989586621679149355"><span class="hs-identifier hs-var">afs</span></a></span><span>
</span><span id="line-465"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679149347"><span class="annot"><span class="annottext">zfas :: Rec ZeroFunc as
</span><a href="#local-6989586621679149347"><span class="hs-identifier hs-var">zfas</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679149342"><span class="annot"><span class="annottext">zfbs :: Rec ZeroFunc bs
</span><a href="#local-6989586621679149342"><span class="hs-identifier hs-var">zfbs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc (as ++ bs) -&gt; (Rec ZeroFunc as, Rec ZeroFunc bs)
forall u (f :: u -&gt; *) (as :: [u]) (bs :: [u]).
RecApplicative as =&gt;
Rec f (as ++ bs) -&gt; (Rec f as, Rec f bs)
</span><a href="Data.Type.Util.html#splitRec"><span class="hs-identifier hs-var">splitRec</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc rs
Rec ZeroFunc (as ++ bs)
</span><a href="#local-6989586621679149352"><span class="hs-identifier hs-var">zfs</span></a></span><span>
</span><span id="line-466"></span><span>    </span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-pragma hs-type">gjoinBV</span></a></span><span> </span><span class="hs-pragma">#-}</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-467"></span><span>
</span><span id="line-468"></span><span class="hs-comment">-- | 'Numeric.Backprop.splitBV' with explicit 'add' and 'zero'.</span><span>
</span><span id="line-469"></span><span class="hs-comment">--</span><span>
</span><span id="line-470"></span><span class="hs-comment">-- @since 0.2.2.0</span><span>
</span><span id="line-471"></span><span class="annot"><a href="Numeric.Backprop.Explicit.html#splitBV"><span class="hs-identifier hs-type">splitBV</span></a></span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149341"><span class="annot"><a href="#local-6989586621679149341"><span class="hs-identifier hs-type">z</span></a></span></span><span> </span><span id="local-6989586621679149340"><span class="annot"><a href="#local-6989586621679149340"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679149339"><span class="annot"><a href="#local-6989586621679149339"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679149338"><span class="annot"><a href="#local-6989586621679149338"><span class="hs-keyword hs-type">as</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-473"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149341"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149340"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-474"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149341"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149339"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-475"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149339"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149338"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149341"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149340"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149341"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149339"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-476"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149339"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span>
</span><span id="line-477"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-478"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149341"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149340"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-479"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149338"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-480"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149341"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149340"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-481"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149338"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-482"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149339"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149341"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149340"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>             </span><span class="hs-comment">-- ^ 'BVar' of value</span><span>
</span><span id="line-483"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149341"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149339"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>               </span><span class="hs-comment">-- ^ 'BVar's of fields</span><span>
</span><span id="line-484"></span><span id="splitBV"><span class="annot"><span class="annottext">splitBV :: AddFunc (Rep (z f) ())
-&gt; Rec AddFunc as
-&gt; ZeroFunc (z f)
-&gt; Rec ZeroFunc as
-&gt; BVar s (z f)
-&gt; z (BVar s)
</span><a href="Numeric.Backprop.Explicit.html#splitBV"><span class="hs-identifier hs-var hs-var">splitBV</span></a></span></span><span> </span><span id="local-6989586621679149337"><span class="annot"><span class="annottext">af :: AddFunc (Rep (z f) ())
</span><a href="#local-6989586621679149337"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621679149336"><span class="annot"><span class="annottext">afs :: Rec AddFunc as
</span><a href="#local-6989586621679149336"><span class="hs-identifier hs-var">afs</span></a></span></span><span> </span><span id="local-6989586621679149335"><span class="annot"><span class="annottext">zf :: ZeroFunc (z f)
</span><a href="#local-6989586621679149335"><span class="hs-identifier hs-var">zf</span></a></span></span><span> </span><span id="local-6989586621679149334"><span class="annot"><span class="annottext">zfs :: Rec ZeroFunc as
</span><a href="#local-6989586621679149334"><span class="hs-identifier hs-var">zfs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-485"></span><span>        </span><span class="annot"><span class="annottext">Rep (z (BVar s)) () -&gt; z (BVar s)
forall a x. Generic a =&gt; Rep a x -&gt; a
</span><span class="hs-identifier hs-var">G.to</span></span><span>
</span><span id="line-486"></span><span>      </span><span class="annot"><span class="annottext">(Rep (z (BVar s)) () -&gt; z (BVar s))
-&gt; (BVar s (z f) -&gt; Rep (z (BVar s)) ())
-&gt; BVar s (z f)
-&gt; z (BVar s)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as
-&gt; Rec ZeroFunc as -&gt; BVar s (Rep (z f) ()) -&gt; Rep (z (BVar s)) ()
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; BVar s (i ()) -&gt; o ()
</span><a href="Numeric.Backprop.Explicit.html#gsplitBV"><span class="hs-identifier hs-var">gsplitBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as
</span><a href="#local-6989586621679149336"><span class="hs-identifier hs-var">afs</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
</span><a href="#local-6989586621679149334"><span class="hs-identifier hs-var">zfs</span></a></span><span>
</span><span id="line-487"></span><span>      </span><span class="annot"><span class="annottext">(BVar s (Rep (z f) ()) -&gt; Rep (z (BVar s)) ())
-&gt; (BVar s (z f) -&gt; BVar s (Rep (z f) ()))
-&gt; BVar s (z f)
-&gt; Rep (z (BVar s)) ()
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">AddFunc (Rep (z f) ())
-&gt; ZeroFunc (z f)
-&gt; Lens' (z f) (Rep (z f) ())
-&gt; BVar s (z f)
-&gt; BVar s (Rep (z f) ())
forall a b s.
Reifies s W =&gt;
AddFunc a -&gt; ZeroFunc b -&gt; Lens' b a -&gt; BVar s b -&gt; BVar s a
</span><a href="Numeric.Backprop.Internal.html#viewVar"><span class="hs-identifier hs-var">viewVar</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc (Rep (z f) ())
</span><a href="#local-6989586621679149337"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc (z f)
</span><a href="#local-6989586621679149335"><span class="hs-identifier hs-var">zf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(z f -&gt; Rep (z f) ())
-&gt; (z f -&gt; Rep (z f) () -&gt; z f) -&gt; Lens' (z f) (Rep (z f) ())
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">z f -&gt; Rep (z f) ()
forall a x. Generic a =&gt; a -&gt; Rep a x
</span><span class="hs-identifier hs-var">from</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149341"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149340"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rep (z f) () -&gt; z f) -&gt; z f -&gt; Rep (z f) () -&gt; z f
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">Rep (z f) () -&gt; z f
forall a x. Generic a =&gt; Rep a x -&gt; a
</span><span class="hs-identifier hs-var">G.to</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#splitBV"><span class="hs-pragma hs-type">splitBV</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-489"></span><span>
</span><span id="line-490"></span><span class="hs-comment">-- | 'Numeric.Backprop.joinBV' with explicit 'add' and 'zero'.</span><span>
</span><span id="line-491"></span><span class="hs-comment">--</span><span>
</span><span id="line-492"></span><span class="hs-comment">-- @since 0.2.2.0</span><span>
</span><span id="line-493"></span><span class="annot"><a href="Numeric.Backprop.Explicit.html#joinBV"><span class="hs-identifier hs-type">joinBV</span></a></span><span>
</span><span id="line-494"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679149330"><span class="annot"><a href="#local-6989586621679149330"><span class="hs-identifier hs-type">z</span></a></span></span><span> </span><span id="local-6989586621679149329"><span class="annot"><a href="#local-6989586621679149329"><span class="hs-identifier hs-type">f</span></a></span></span><span> </span><span id="local-6989586621679149328"><span class="annot"><a href="#local-6989586621679149328"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span id="local-6989586621679149327"><span class="annot"><a href="#local-6989586621679149327"><span class="hs-keyword hs-type">as</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-495"></span><span>       </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149330"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149329"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-496"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Generic</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149330"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149328"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#BVGroup"><span class="hs-identifier hs-type">BVGroup</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149328"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149327"><span class="hs-keyword hs-type">as</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149330"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149329"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149330"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149328"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-498"></span><span>       </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Reifies</span></span><span> </span><span class="annot"><a href="#local-6989586621679149328"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#W"><span class="hs-identifier hs-type">W</span></a></span><span>
</span><span id="line-499"></span><span>       </span><span class="hs-special">)</span><span>
</span><span id="line-500"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149330"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149329"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-501"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#AddFunc"><span class="hs-identifier hs-type">AddFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149327"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-502"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Rep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149330"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149329"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Rec</span></span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#ZeroFunc"><span class="hs-identifier hs-type">ZeroFunc</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149327"><span class="hs-keyword hs-type">as</span></a></span><span>
</span><span id="line-504"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679149330"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149328"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span>           </span><span class="hs-comment">-- ^ 'BVar's of fields</span><span>
</span><span id="line-505"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149328"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149330"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149329"><span class="hs-identifier hs-type">f</span></a></span><span class="hs-special">)</span><span>         </span><span class="hs-comment">-- ^ 'BVar' of combined value</span><span>
</span><span id="line-506"></span><span id="joinBV"><span class="annot"><span class="annottext">joinBV :: AddFunc (z f)
-&gt; Rec AddFunc as
-&gt; ZeroFunc (Rep (z f) ())
-&gt; Rec ZeroFunc as
-&gt; z (BVar s)
-&gt; BVar s (z f)
</span><a href="Numeric.Backprop.Explicit.html#joinBV"><span class="hs-identifier hs-var hs-var">joinBV</span></a></span></span><span> </span><span id="local-6989586621679149326"><span class="annot"><span class="annottext">af :: AddFunc (z f)
</span><a href="#local-6989586621679149326"><span class="hs-identifier hs-var">af</span></a></span></span><span> </span><span id="local-6989586621679149325"><span class="annot"><span class="annottext">afs :: Rec AddFunc as
</span><a href="#local-6989586621679149325"><span class="hs-identifier hs-var">afs</span></a></span></span><span> </span><span id="local-6989586621679149324"><span class="annot"><span class="annottext">zf :: ZeroFunc (Rep (z f) ())
</span><a href="#local-6989586621679149324"><span class="hs-identifier hs-var">zf</span></a></span></span><span> </span><span id="local-6989586621679149323"><span class="annot"><span class="annottext">zfs :: Rec ZeroFunc as
</span><a href="#local-6989586621679149323"><span class="hs-identifier hs-var">zfs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-507"></span><span>        </span><span class="annot"><span class="annottext">AddFunc (z f)
-&gt; ZeroFunc (Rep (z f) ())
-&gt; Lens' (Rep (z f) ()) (z f)
-&gt; BVar s (Rep (z f) ())
-&gt; BVar s (z f)
forall a b s.
Reifies s W =&gt;
AddFunc a -&gt; ZeroFunc b -&gt; Lens' b a -&gt; BVar s b -&gt; BVar s a
</span><a href="Numeric.Backprop.Internal.html#viewVar"><span class="hs-identifier hs-var">viewVar</span></a></span><span> </span><span class="annot"><span class="annottext">AddFunc (z f)
</span><a href="#local-6989586621679149326"><span class="hs-identifier hs-var">af</span></a></span><span> </span><span class="annot"><span class="annottext">ZeroFunc (Rep (z f) ())
</span><a href="#local-6989586621679149324"><span class="hs-identifier hs-var">zf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Rep (z f) () -&gt; z f)
-&gt; (Rep (z f) () -&gt; z f -&gt; Rep (z f) ())
-&gt; Lens' (Rep (z f) ()) (z f)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">Rep (z f) () -&gt; z f
forall a x. Generic a =&gt; Rep a x -&gt; a
</span><span class="hs-identifier hs-var">G.to</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(z f -&gt; Rep (z f) ()) -&gt; Rep (z f) () -&gt; z f -&gt; Rep (z f) ()
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">z f -&gt; Rep (z f) ()
forall a x. Generic a =&gt; a -&gt; Rep a x
</span><span class="hs-identifier hs-var">from</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-508"></span><span>      </span><span class="annot"><span class="annottext">(BVar s (Rep (z f) ()) -&gt; BVar s (z f))
-&gt; (z (BVar s) -&gt; BVar s (Rep (z f) ()))
-&gt; z (BVar s)
-&gt; BVar s (z f)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as
-&gt; Rec ZeroFunc as -&gt; Rep (z (BVar s)) () -&gt; BVar s (Rep (z f) ())
forall s (as :: [*]) (i :: * -&gt; *) (o :: * -&gt; *).
BVGroup s as i o =&gt;
Rec AddFunc as -&gt; Rec ZeroFunc as -&gt; o () -&gt; BVar s (i ())
</span><a href="Numeric.Backprop.Explicit.html#gjoinBV"><span class="hs-identifier hs-var">gjoinBV</span></a></span><span> </span><span class="annot"><span class="annottext">Rec AddFunc as
</span><a href="#local-6989586621679149325"><span class="hs-identifier hs-var">afs</span></a></span><span> </span><span class="annot"><span class="annottext">Rec ZeroFunc as
</span><a href="#local-6989586621679149323"><span class="hs-identifier hs-var">zfs</span></a></span><span>
</span><span id="line-509"></span><span>      </span><span class="annot"><span class="annottext">(Rep (z (BVar s)) () -&gt; BVar s (Rep (z f) ()))
-&gt; (z (BVar s) -&gt; Rep (z (BVar s)) ())
-&gt; z (BVar s)
-&gt; BVar s (Rep (z f) ())
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">z (BVar s) -&gt; Rep (z (BVar s)) ()
forall a x. Generic a =&gt; a -&gt; Rep a x
</span><span class="hs-identifier hs-var">from</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679149330"><span class="hs-identifier hs-type">z</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Numeric.Backprop.Internal.html#BVar"><span class="hs-identifier hs-type">BVar</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679149328"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-510"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Numeric.Backprop.Explicit.html#joinBV"><span class="hs-pragma hs-type">joinBV</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-511"></span></pre></body></html>